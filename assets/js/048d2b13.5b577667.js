"use strict";(self.webpackChunkkrateo_v_2_docs=self.webpackChunkkrateo_v_2_docs||[]).push([[500],{432:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>t,metadata:()=>a,toc:()=>l});var s=i(7624),r=i(2172);const t={},o="Krateo OASGen Provider",a={id:"key-concepts/kog/oasgen-provider",title:"Krateo OASGen Provider",description:"The Krateo OASGen Provider is a Kubernetes controller that generates Custom Resource Definitions (CRDs) and controllers to manage resources directly from OpenAPI Specification (OAS) 3.1 documents (with support for OAS 3.0). It enables seamless integration of API-defined resources into Kubernetes environments.",source:"@site/docs/20-key-concepts/40-kog/10-oasgen-provider.md",sourceDirName:"20-key-concepts/40-kog",slug:"/key-concepts/kog/oasgen-provider",permalink:"/key-concepts/kog/oasgen-provider",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:10,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"finops-prometheus-scraper-generic",permalink:"/key-concepts/kcf/finops-components/finops-prometheus-scraper-generic"},next:{title:"Rest Dynamic Controller",permalink:"/key-concepts/kog/rest-dynamic-controller"}},c={},l=[{value:"Summary",id:"summary",level:2},{value:"Glossary",id:"glossary",level:2},{value:"Architecture",id:"architecture",level:2},{value:"Workflow",id:"workflow",level:2},{value:"Requirements",id:"requirements",level:2},{value:"RestDefinition Specifications",id:"restdefinition-specifications",level:2},{value:"Authentication",id:"authentication",level:3},{value:"API Endpoints Requirements",id:"api-endpoints-requirements",level:3},{value:"Getting Started",id:"getting-started",level:2},{value:"Example",id:"example",level:2},{value:"Security Features",id:"security-features",level:2},{value:"Best Practices",id:"best-practices",level:2},{value:"Troubleshooting",id:"troubleshooting",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.M)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"krateo-oasgen-provider",children:"Krateo OASGen Provider"}),"\n",(0,s.jsx)(n.p,{children:"The Krateo OASGen Provider is a Kubernetes controller that generates Custom Resource Definitions (CRDs) and controllers to manage resources directly from OpenAPI Specification (OAS) 3.1 documents (with support for OAS 3.0). It enables seamless integration of API-defined resources into Kubernetes environments."}),"\n",(0,s.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#summary",children:"Summary"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#glossary",children:"Glossary"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#architecture",children:"Architecture"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#workflow",children:"Workflow"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#requirements",children:"Requirements"})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#restdefinition-specifications",children:"RestDefinition Specifications"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#authentication",children:"Authentication"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#api-endpoints-requirements",children:"API Endpoints Requirements"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#getting-started",children:"Getting Started"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#example",children:"Example"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#security-features",children:"Security Features"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#best-practices",children:"Best Practices"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#troubleshooting",children:"Troubleshooting"})}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"glossary",children:"Glossary"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"CRD (Custom Resource Definition):"})," A Kubernetes resource that defines custom objects and their schemas."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"RestDefinition:"})," A custom resource that defines how API resources are managed in Kubernetes based on OAS specifications."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"RDC (Rest Dynamic Controller):"})," A controller deployed by the provider to manage resources defined by a RestDefinition."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"OAS (OpenAPI Specification):"})," A standard, language-agnostic interface description for REST APIs."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"WebService:"})," A wrapper service that maintains consistent API interfaces when needed."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"BasicAuth:"})," A simple authentication method using username and password credentials."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"architecture",children:"Architecture"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Generator Architecture Image",src:i(852).c+"",title:"Generator Architecture",width:"920",height:"371"})}),"\n",(0,s.jsx)(n.p,{children:"The diagram illustrates how the OASGen Provider processes OpenAPI Specifications to generate CRDs and deploy the Rest Dynamic Controller (RDC). The RDC manages custom resources and interacts with external APIs, optionally through wrapper web services when needed."}),"\n",(0,s.jsx)(n.h2,{id:"workflow",children:"Workflow"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"User applies a RestDefinition CR"}),"\n",(0,s.jsx)(n.li,{children:"Provider fetches the OAS specification"}),"\n",(0,s.jsx)(n.li,{children:"Provider generates CRD based on the OAS schema"}),"\n",(0,s.jsx)(n.li,{children:"Provider deploys the Rest Dynamic Controller"}),"\n",(0,s.jsx)(n.li,{children:"Controller manages custom resources according to API specifications"}),"\n",(0,s.jsx)(n.li,{children:"Resources are synchronized with external APIs"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"requirements",children:"Requirements"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Kubernetes cluster (v1.20+ recommended)"}),"\n",(0,s.jsxs)(n.li,{children:["Krateo BFF installed in the ",(0,s.jsx)(n.code,{children:"krateo-system"})," namespace"]}),"\n",(0,s.jsx)(n.li,{children:"OpenAPI Specification 3.0+ documents for your APIs"}),"\n",(0,s.jsx)(n.li,{children:"Network access to API endpoints from the cluster"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"restdefinition-specifications",children:"RestDefinition Specifications"}),"\n",(0,s.jsx)(n.h3,{id:"authentication",children:"Authentication"}),"\n",(0,s.jsx)(n.p,{children:"The provider supports Basic Authentication out of the box and will generate appropriate CRDs if the OAS specifies authentication methods."}),"\n",(0,s.jsx)(n.p,{children:"Example BasicAuth CR:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"kind: BasicAuth\napiVersion: azure.devops.com/v1alpha1\nmetadata:\n  name: basicauth-azure\nspec:\n  username: admin\n  passwordRef:\n    name: azdevops-gen\n    namespace: default\n    key: token\n"})}),"\n",(0,s.jsx)(n.h3,{id:"api-endpoints-requirements",children:"API Endpoints Requirements"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Field names must be consistent across all actions (",(0,s.jsx)(n.code,{children:"create"}),", ",(0,s.jsx)(n.code,{children:"update"}),", ",(0,s.jsx)(n.code,{children:"findby"}),", ",(0,s.jsx)(n.code,{children:"get"}),", ",(0,s.jsx)(n.code,{children:"delete"}),")"]}),"\n",(0,s.jsx)(n.li,{children:"API responses must contain all fields defined in the CRD"}),"\n",(0,s.jsx)(n.li,{children:"Path parameters and body fields should use consistent naming"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"getting-started",children:"Getting Started"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Install Krateo BFF:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"helm repo add krateo https://charts.krateo.io\nhelm repo update\nhelm install bff krateo/bff --namespace krateo-system --create-namespace\n"})}),"\n",(0,s.jsxs)(n.ol,{start:"2",children:["\n",(0,s.jsx)(n.li,{children:"Install OASGen Provider:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"helm install krateo-oasgen-provider krateo/oasgen-provider --namespace krateo-system\n"})}),"\n",(0,s.jsxs)(n.ol,{start:"3",children:["\n",(0,s.jsx)(n.li,{children:"Apply a RestDefinition:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"kind: RestDefinition\napiVersion: swaggergen.krateo.io/v1alpha1\nmetadata:\n  name: def-pipelinepermissions\n  namespace: default\nspec: \n  oasPath: https://raw.githubusercontent.com/krateoplatformops/azuredevops-oas3/main/approvalandchecks/pipelinepermissions.yaml\n  resourceGroup: azure.devops.com\n  resource: \n    kind: PipelinePermission\n    identifiers:\n      - resourceType\n      - resourceId\n    verbsDescription:\n    - action: findby\n      method: POST\n      path: /{organization}/{project}/_apis/pipelines/pipelinepermissions/{resourceType}/{resourceId}\n    - action: get\n      method: GET\n      path: /{organization}/{project}/_apis/pipelines/pipelinepermissions/{resourceType}/{resourceId}\n    - action: update\n      method: PATCH\n      path: /{organization}/{project}/_apis/pipelines/pipelinepermissions/{resourceType}/{resourceId}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"example",children:"Example"}),"\n",(0,s.jsx)(n.p,{children:"Here's a complete example for managing Azure DevOps Pipeline Permissions:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Apply the RestDefinition (as shown above)"}),"\n",(0,s.jsx)(n.li,{children:"Create a BasicAuth secret:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"kubectl create secret generic azdevops-gen --from-literal=token=your-pat-token\n"})}),"\n",(0,s.jsxs)(n.ol,{start:"3",children:["\n",(0,s.jsx)(n.li,{children:"Apply the PipelinePermission CR:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'kind: PipelinePermission\napiVersion: azure.devops.com/v1alpha1\nmetadata:\n  name: pipelineperm-1\n  namespace: default\n  annotations:\n    krateo.io/connector-verbose: "true"\nspec:\n  authenticationRefs:\n    basicAuthRef: basicauth-azure\n  api-version: 7.0-preview.1\n  organization: yourorg\n  project: yourproject\n  resourceType: environment\n  resourceId: "1"\n  pipelines:\n  - id: 42\n    authorized: false\n'})}),"\n",(0,s.jsx)(n.h2,{id:"security-features",children:"Security Features"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Automatic generation of RBAC policies for custom resources"}),"\n",(0,s.jsx)(n.li,{children:"Secure credential management through Kubernetes secrets"}),"\n",(0,s.jsx)(n.li,{children:"Field validation based on OAS schemas"}),"\n",(0,s.jsx)(n.li,{children:"Optional web service wrappers for additional security layers"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Always use OAS 3.0+ specifications"}),"\n",(0,s.jsx)(n.li,{children:"Maintain consistent field naming across API endpoints"}),"\n",(0,s.jsx)(n.li,{children:"Use web service wrappers when API interfaces are inconsistent"}),"\n",(0,s.jsx)(n.li,{children:"Regularly update OAS documents to match API changes"}),"\n",(0,s.jsxs)(n.li,{children:["Monitor controller logs with ",(0,s.jsx)(n.code,{children:'krateo.io/connector-verbose: "true"'})]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Conversion from OAS 2.0 to 3.0:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Use ",(0,s.jsx)(n.a,{href:"https://editor.swagger.io",children:"Swagger Editor"})," for conversion"]}),"\n",(0,s.jsx)(n.li,{children:"Manually review and correct any conversion issues"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Inconsistent API interfaces:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Create a web service wrapper to normalize interfaces"}),"\n",(0,s.jsxs)(n.li,{children:["Example implementations available in ",(0,s.jsx)(n.a,{href:"https://github.com/krateoplatformops/azuredevops-oas3-plugin",children:"Java"})," and ",(0,s.jsx)(n.a,{href:"https://github.com/krateoplatformops/github-oas3-plugin",children:"Python"})]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Authentication issues:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Verify secret references in BasicAuth CRs"}),"\n",(0,s.jsx)(n.li,{children:"Check network connectivity to API endpoints"}),"\n",(0,s.jsx)(n.li,{children:"Enable verbose logging with annotations"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["For complete CRD specifications, visit ",(0,s.jsx)(n.a,{href:"https://doc.crds.dev/github.com/krateoplatformops/oasgen-provider",children:"this link"}),"."]})]})}function h(e={}){const{wrapper:n}={...(0,r.M)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},852:(e,n,i)=>{i.d(n,{c:()=>s});const s=i.p+"assets/images/generator-afdacce834f371605ecc01502040fd29.png"},2172:(e,n,i)=>{i.d(n,{I:()=>a,M:()=>o});var s=i(1504);const r={},t=s.createContext(r);function o(e){const n=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);