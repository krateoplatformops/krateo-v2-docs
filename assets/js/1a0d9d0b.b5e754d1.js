"use strict";(self.webpackChunkkrateo_v_2_docs=self.webpackChunkkrateo_v_2_docs||[]).push([[688],{9336:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>o,contentTitle:()=>r,default:()=>d,frontMatter:()=>s,metadata:()=>c,toc:()=>l});var t=a(7624),i=a(2172);const s={},r="backend",c={id:"key-concepts/kcp/backend",title:"backend",description:"The task of backend is to declaratively provide how the graphic elements of krateo-frontend must be enhanced.",source:"@site/docs/20-key-concepts/20-kcp/30-backend.md",sourceDirName:"20-key-concepts/20-kcp",slug:"/key-concepts/kcp/backend",permalink:"/key-concepts/kcp/backend",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:30,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"bff",permalink:"/key-concepts/kcp/bff"},next:{title:"authn",permalink:"/key-concepts/kcp/authn"}},o={},l=[{value:"Summary",id:"summary",level:2},{value:"Overview",id:"overview",level:2},{value:"Architecture",id:"architecture",level:2},{value:"API",id:"api",level:2},{value:"List of all available APIs",id:"list-of-all-available-apis",level:3},{value:"OpenAPI",id:"openapi",level:3}];function p(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",...(0,i.M)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"backend",children:"backend"}),"\n",(0,t.jsx)(n.p,{children:"The task of backend is to declaratively provide how the graphic elements of krateo-frontend must be enhanced."}),"\n",(0,t.jsx)(n.p,{children:"\ud83d\udc47 Below is an example snippet:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:'apiVersion: v1\nkind: Secret\ntype: Opaque\nmetadata:\n  name: typicode-endpoint\n  namespace: demo-system\nstringData:\n  server-url: https://jsonplaceholder.typicode.com\n---\napiVersion: templates.krateo.io/v1alpha1\nkind: Widget\nmetadata:\n  name: external-api\n  namespace: demo-system\nspec:\n  type: card\n  propsRef:\n    name: card-props\n    namespace: demo-system\n  actions:\n  - template:\n      apiVersion: templates.krateo.io/v1alpha1\n      resource: forms\n      name: fireworksapp\n      namespace: demo-system\n  - template:\n      apiVersion: templates.krateo.io/v1alpha1\n      resource: widgets\n      name: external-api\n      namespace: demo-system\n  app:\n    template:\n      title: ${ .api2.items[0] | (.name  + " -> " + .email) }\n      content: ${ .api2.items[0].body }\n  api:\n  - name: api1\n    path: "/todos/1"\n    endpointRef:\n      name: typicode-endpoint\n      namespace: demo-system\n    verb: GET\n    headers:\n    - \'Accept: application/json\'\n  - name: api2\n    dependOn: api1\n    path: ${ "/todos/" + (.api1.id|tostring) +  "/comments" }\n    endpointRef:\n      name: typicode-endpoint\n      namespace: demo-system\n    verb: GET\n    headers:\n    - \'Accept: application/json\'\n'})}),"\n",(0,t.jsxs)(n.p,{children:["A ",(0,t.jsx)(n.em,{children:"Widget"})," is a Krateo graphic component composed of various properties (",(0,t.jsx)(n.em,{children:"spec.app"})," section)."]}),"\n",(0,t.jsxs)(n.p,{children:["The widget includes call2actions such as deleting the cardTemplate itself (via the trash can button). Any action can be declared under the ",(0,t.jsx)(n.em,{children:"spec.actions"})," section."]}),"\n",(0,t.jsx)(n.p,{children:"Properties can be filled in manually or obtained by querying an API."}),"\n",(0,t.jsx)(n.p,{children:"This API can represent a further call to the Kubernetes server API (and in this case the backend will make a call using the client certificate) or to an external API (and in this case it will use the explicit credentials)."}),"\n",(0,t.jsx)(n.p,{children:"The backend can also make a sequence of API calls and can also iterate an array arrived in response to the call."}),"\n",(0,t.jsxs)(n.p,{children:["Further examples can be found here: ",(0,t.jsx)(n.a,{href:"https://github.com/krateoplatformops/backend/tree/main/testdata",children:"https://github.com/krateoplatformops/backend/tree/main/testdata"}),"."]}),"\n",(0,t.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"#overview",children:"Overview"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"#architecture",children:"Architecture"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"#api",children:"API"})}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,t.jsx)(n.p,{children:"It provides all the APIs necessary for the Krateo Frontend."}),"\n",(0,t.jsx)(n.p,{children:"This is an extension API server to work with the aggregation layer that allows the Kubernetes apiserver to be extended with Krateo additional APIs, which are not part of the core Kubernetes APIs."}),"\n",(0,t.jsx)(n.h2,{id:"architecture",children:"Architecture"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"Krateo Backend",src:a(4220).c+"",width:"595",height:"570"})}),"\n",(0,t.jsx)(n.h2,{id:"api",children:"API"}),"\n",(0,t.jsx)(n.h3,{id:"list-of-all-available-apis",children:"List of all available APIs"}),"\n",(0,t.jsx)(n.p,{children:"To get the list of all available APIs:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"$ kubectl api-resources --api-group=templates.krateo.io\n"})}),"\n",(0,t.jsx)(n.h3,{id:"openapi",children:"OpenAPI"}),"\n",(0,t.jsx)(n.p,{children:"To get the OpenAPI definitions for all available APIs:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"$ kubectl get --raw /openapi/v3/apis/templates.krateo.io/v1alpha1\n"})}),"\n",(0,t.jsx)(n.p,{children:"if you have a viewing tool you can redirect the output to a file:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"$ kubectl get --raw /openapi/v3/apis/templates.krateo.io/v1alpha1 > krateo-backend-api.json\n"})}),"\n",(0,t.jsx)(n.p,{children:"and then open the saved file with the tool."})]})}function d(e={}){const{wrapper:n}={...(0,i.M)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(p,{...e})}):p(e)}},4220:(e,n,a)=>{a.d(n,{c:()=>t});const t=a.p+"assets/images/backend-architecture-f142f8387e9a204ea51604f611d1c7e7.png"},2172:(e,n,a)=>{a.d(n,{I:()=>c,M:()=>r});var t=a(1504);const i={},s=t.createContext(i);function r(e){const n=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);