"use strict";(self.webpackChunkkrateo_v_2_docs=self.webpackChunkkrateo_v_2_docs||[]).push([[664],{4488:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>c,contentTitle:()=>r,default:()=>h,frontMatter:()=>i,metadata:()=>n,toc:()=>p});var s=a(7624),o=a(2172);const i={description:"Migrating Krateo PlatformOps from v2.4.3 to v2.5.0 (AKS example)",sidebar_label:"Migrating Krateo PlatformOps from v2.4.3 to v2.5.0 (AKS example)"},r="Migrating Krateo PlatformOps from v2.4.3 to v2.5.0 (AKS example)",n={id:"how-to-guides/migrate-krateo/migrating-from-v2-4-3-to-v2-5-0",title:"Migrating Krateo PlatformOps from v2.4.3 to v2.5.0 (AKS example)",description:"Migrating Krateo PlatformOps from v2.4.3 to v2.5.0 (AKS example)",source:"@site/docs/30-how-to-guides/20-migrate-krateo/10-migrating-from-v2-4-3-to-v2-5-0.md",sourceDirName:"30-how-to-guides/20-migrate-krateo",slug:"/how-to-guides/migrate-krateo/migrating-from-v2-4-3-to-v2-5-0",permalink:"/how-to-guides/migrate-krateo/migrating-from-v2-4-3-to-v2-5-0",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:10,frontMatter:{description:"Migrating Krateo PlatformOps from v2.4.3 to v2.5.0 (AKS example)",sidebar_label:"Migrating Krateo PlatformOps from v2.4.3 to v2.5.0 (AKS example)"},sidebar:"tutorialSidebar",previous:{title:"Installing Krateo PlatformOps using security context",permalink:"/how-to-guides/install-krateo/installing-krateo-with-securitycontext"},next:{title:"Migrating from Crossplane Composition to Helm",permalink:"/how-to-guides/migrate-krateo/migrating-from-crossplane-composition-to-helm"}},c={},p=[{value:"Starting point: Krateo 2.4.3, Fireworksapp compositiondefinition 1.1.15, fireworksapp-tomigrate composition",id:"starting-point-krateo-243-fireworksapp-compositiondefinition-1115-fireworksapp-tomigrate-composition",level:2},{value:"Scale Krateo 2.4.3 core-provider to zero replicas",id:"scale-krateo-243-core-provider-to-zero-replicas",level:3},{value:"Scale Krateo 2.4.3 oasgen-provider to zero replicas",id:"scale-krateo-243-oasgen-provider-to-zero-replicas",level:3},{value:"Ending point: Krateo 2.5.0, Fireworksapp compositiondefinition 2.0.2 (version changed within the same compositiondefinition, previous fireworksapp-tomigrate composition",id:"ending-point-krateo-250-fireworksapp-compositiondefinition-202-version-changed-within-the-same-compositiondefinition-previous-fireworksapp-tomigrate-composition",level:2},{value:"Scale Krateo 2.5.0 core-provider to zero replicas",id:"scale-krateo-250-core-provider-to-zero-replicas",level:3},{value:"Scale Krateo 2.4.3 core-provider to one replica",id:"scale-krateo-243-core-provider-to-one-replica",level:3}];function l(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.M)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.h1,{id:"migrating-krateo-platformops-from-v243-to-v250-aks-example",children:"Migrating Krateo PlatformOps from v2.4.3 to v2.5.0 (AKS example)"}),"\n",(0,s.jsx)(t.p,{children:"Krateo 2.5.0 introduces a new set of manifests to declare widgets in the portal. The difference with the previous version resides in the following:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"API orchestration has been decoupled from the data preparation for the portal. This assumption requires implementing a RESTAction that the widget will reference"}),"\n",(0,s.jsx)(t.li,{children:"New widgets are strongly typified, meaning that there is a specific Kind for a particular widget, and properties are expressed in the dedicated CRD"}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"The schema for widgets until the 2.4.3 version is the following:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"apiVersion: templates.krateo.io/v1alpha1\nkind: Collection\nspec:\n  type: panel\n  propsRef:\n  widgetsRefs: []\n---\napiVersion: templates.krateo.io/v1alpha1\nkind: Widget\nspec:\n  type:\n  propsRef:\n  app:\n    template:\n  API: []\n  actions: []\n"})}),"\n",(0,s.jsx)(t.p,{children:"The schema for widget from 2.5.0 version is the following:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"kind: LineChart\napiVersion: widgets.templates.krateo.io/v1beta1\nspec:\n  widgetData:\n  apiRef: \n  widgetDataTemplate: []\n  resourcesRefs: []\n  resourcesRefsTemplate: []\n"})}),"\n",(0,s.jsxs)(t.p,{children:["Updated schemas for the new frontend are collected here: ",(0,s.jsx)(t.a,{href:"https://github.com/krateoplatformops/frontend-chart/tree/main/chart/crds",children:"https://github.com/krateoplatformops/frontend-chart/tree/main/chart/crds"})]}),"\n",(0,s.jsx)(t.h2,{id:"starting-point-krateo-243-fireworksapp-compositiondefinition-1115-fireworksapp-tomigrate-composition",children:"Starting point: Krateo 2.4.3, Fireworksapp compositiondefinition 1.1.15, fireworksapp-tomigrate composition"}),"\n",(0,s.jsx)(t.p,{children:"Krateo 2.4.3 has been installed on AKS in the following way:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"helm upgrade installer installer \\\n --repo https://charts.krateo.io \\\n --namespace krateo-system \\\n --create-namespace \\\n --set krateoplatformops.service.type=LoadBalancer \\\n --set krateoplatformops.service.externalIpAvailable=true \\\n --install \\\n --version 2.4.3 \\\n --wait\n"})}),"\n",(0,s.jsxs)(t.p,{children:["This is the ",(0,s.jsx)(t.code,{children:"login"})," page of Krateo 2.4.3:\n",(0,s.jsx)(t.img,{src:"https://github.com/user-attachments/assets/c6896e72-0a29-4f48-8f5e-00e19d758f78",alt:"image"})]}),"\n",(0,s.jsxs)(t.p,{children:["This is the ",(0,s.jsx)(t.code,{children:"dashboard"})," page of an empty Krateo 2.4.3 installation:\n",(0,s.jsx)(t.img,{src:"https://github.com/user-attachments/assets/7b3b3a6f-d210-4a76-8bac-a67f98e91b70",alt:"image"})]}),"\n",(0,s.jsxs)(t.p,{children:["Let's apply a Fireworksapp ",(0,s.jsx)(t.code,{children:"compositiondefinition"})," version 1.1.15: ",(0,s.jsx)(t.a,{href:"https://github.com/krateoplatformops/krateo-v2-template-fireworksapp",children:"https://github.com/krateoplatformops/krateo-v2-template-fireworksapp"}),", follow instruction for Krateo version 2.4.3 or lower"]}),"\n",(0,s.jsxs)(t.p,{children:["This is the ",(0,s.jsx)(t.code,{children:"dashboard"})," page of Krateo 2.4.3 installation with the installed ",(0,s.jsx)(t.code,{children:"compositiondefinition"})," with status ",(0,s.jsx)(t.code,{children:"Ready:False"}),":\n",(0,s.jsx)(t.img,{src:"https://github.com/user-attachments/assets/3b8f8aa7-4e2c-4b3e-b94c-8bd3b8fe347f",alt:"image"})]}),"\n",(0,s.jsxs)(t.p,{children:["This is the ",(0,s.jsx)(t.code,{children:"dashboard"})," page of Krateo 2.4.3 installation with the install ",(0,s.jsx)(t.code,{children:"compositiondefinition"})," that, after a while,e has status ",(0,s.jsx)(t.code,{children:"Ready:True"}),":\n",(0,s.jsx)(t.img,{src:"https://github.com/user-attachments/assets/5146e08c-e250-4caa-b9e9-250120dd5470",alt:"image"})]}),"\n",(0,s.jsxs)(t.p,{children:["Moving to the ",(0,s.jsx)(t.code,{children:"template"})," page of Krateo 2.4.3 installation, a Card is available:\n",(0,s.jsx)(t.img,{src:"https://github.com/user-attachments/assets/66dc1098-913e-4035-9b85-bc8dfd3b123a",alt:"image"})]}),"\n",(0,s.jsxs)(t.p,{children:["Let's click on the Card to open the Drawer with the CustomForm:\n",(0,s.jsx)(t.img,{src:"https://github.com/user-attachments/assets/3b39de93-0d2a-4181-99c8-d95128943ba3",alt:"image"})]}),"\n",(0,s.jsxs)(t.p,{children:["Let's fill the form:\n",(0,s.jsx)(t.img,{src:"https://github.com/user-attachments/assets/c63657fb-8547-4215-b50d-d33f3317f09b",alt:"image"}),"\n",(0,s.jsx)(t.img,{src:"https://github.com/user-attachments/assets/a26c9878-6179-4120-8062-c8b9d9b60dce",alt:"image"})]}),"\n",(0,s.jsxs)(t.p,{children:["Krateo automatically opens the ",(0,s.jsx)(t.code,{children:"compositions"})," page once the ",(0,s.jsx)(t.code,{children:"fireworksapp-tomigrate"})," composition is created:\n",(0,s.jsx)(t.img,{src:"https://github.com/user-attachments/assets/8f02d68a-360f-4543-8bea-9f6ff29be4b0",alt:"image"})]}),"\n",(0,s.jsxs)(t.p,{children:["Let's navigate the ",(0,s.jsx)(t.code,{children:"fireworksapp-tomigrate"})," composition widgets:\n",(0,s.jsx)(t.img,{src:"https://github.com/user-attachments/assets/95acd13c-8249-4400-9dce-6af0cdee52f0",alt:"image"}),"\n",(0,s.jsx)(t.img,{src:"https://github.com/user-attachments/assets/7de61d25-e820-4503-9f5f-6ba52772609f",alt:"image"}),"\n",(0,s.jsx)(t.img,{src:"https://github.com/user-attachments/assets/2b7212dc-16e6-489f-a3d7-7ef0d74bbea3",alt:"image"}),"\n",(0,s.jsx)(t.img,{src:"https://github.com/user-attachments/assets/84a831c5-2953-4ea4-9670-9d7d69aae638",alt:"image"}),"\n",(0,s.jsx)(t.img,{src:"https://github.com/user-attachments/assets/d67d6dd8-16a4-40c4-b746-92316a2676e2",alt:"image"})]}),"\n",(0,s.jsxs)(t.p,{children:["This is the ",(0,s.jsx)(t.code,{children:"dashboard"})," page of Krateo 2.4.3 installation with the installed ",(0,s.jsx)(t.code,{children:"fireworksapp-tomigrate"})," composition:\n",(0,s.jsx)(t.img,{src:"https://github.com/user-attachments/assets/3f3f0489-8614-4551-a8b5-684452e86f0c",alt:"image"})]}),"\n",(0,s.jsx)(t.h3,{id:"scale-krateo-243-core-provider-to-zero-replicas",children:"Scale Krateo 2.4.3 core-provider to zero replicas"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sh",children:"kubectl scale deployment core-provider --replicas=0 -n krateo-system\n"})}),"\n",(0,s.jsx)(t.h3,{id:"scale-krateo-243-oasgen-provider-to-zero-replicas",children:"Scale Krateo 2.4.3 oasgen-provider to zero replicas"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sh",children:"kubectl scale deployment oasgen-provider --replicas=0 -n krateo-system\n"})}),"\n",(0,s.jsx)(t.h2,{id:"ending-point-krateo-250-fireworksapp-compositiondefinition-202-version-changed-within-the-same-compositiondefinition-previous-fireworksapp-tomigrate-composition",children:"Ending point: Krateo 2.5.0, Fireworksapp compositiondefinition 2.0.2 (version changed within the same compositiondefinition, previous fireworksapp-tomigrate composition"}),"\n",(0,s.jsx)(t.p,{children:"A parallel installation of Krateo 2.5.0 has been installed on AKS in the following way:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sh",children:"git clone --branch 249-prepare-release-250 https://github.com/krateoplatformops/installer-chart.git\ncd installer-chart\nhelm install installer-v2 ./chart --namespace krateo-v2-system --create-namespace -f ./chart/values.yaml --wait\n"})}),"\n",(0,s.jsx)(t.h3,{id:"scale-krateo-250-core-provider-to-zero-replicas",children:"Scale Krateo 2.5.0 core-provider to zero replicas"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sh",children:"kubectl scale deployment core-provider --replicas=0 -n krateo-v2-system\n"})}),"\n",(0,s.jsx)(t.h3,{id:"scale-krateo-243-core-provider-to-one-replica",children:"Scale Krateo 2.4.3 core-provider to one replica"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sh",children:"kubectl scale deployment core-provider --replicas=1 -n krateo-system\n"})}),"\n",(0,s.jsxs)(t.p,{children:["This is the ",(0,s.jsx)(t.code,{children:"login"})," page of Krateo 2.5.0:\n",(0,s.jsx)(t.img,{src:"https://github.com/user-attachments/assets/c8a94619-b282-4f74-acbb-bdf1be7785cd",alt:"image"})]}),"\n",(0,s.jsxs)(t.p,{children:["This is the ",(0,s.jsx)(t.code,{children:"dashboard"})," page of a Krateo 2.5.0 installation:\n",(0,s.jsx)(t.img,{src:"https://github.com/user-attachments/assets/c6aebd83-4b14-4ced-89a4-388acb06a38c",alt:"image"})]}),"\n",(0,s.jsxs)(t.p,{children:["Let's configure Krateo 2.5.0 for Fireworksapp ",(0,s.jsx)(t.code,{children:"compositiondefinition"})," version 2.0.2: ",(0,s.jsx)(t.a,{href:"https://github.com/krateoplatformops/krateo-v2-template-fireworksapp",children:"https://github.com/krateoplatformops/krateo-v2-template-fireworksapp"}),", follow instruction for Krateo >= 2.5.0"]}),"\n",(0,s.jsxs)(t.p,{children:["Let's navigate the ",(0,s.jsx)(t.code,{children:"compositions"})," page of Krateo 2.5.0 - it is empty since the composition ",(0,s.jsx)(t.code,{children:"fireworksapp-tomigrate"})," has not been migrated yet:\n",(0,s.jsx)(t.img,{src:"https://github.com/user-attachments/assets/a052735d-c2a3-4153-8233-881711d5b930",alt:"image"})]}),"\n",(0,s.jsxs)(t.p,{children:["Let's migrate the composition, changing the Fireworksapp ",(0,s.jsx)(t.code,{children:"compositiondefinition"})," version from 1.1.15 to 2.0.2:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sh",children:"cat <<EOF | kubectl apply -f -\napiVersion: core.krateo.io/v1alpha1\nkind: CompositionDefinition\nmetadata:\n  name: fireworksapp\n  namespace: fireworksapp-system\nspec:\n  chart:\n    repo: fireworks-app\n    url: https://charts.krateo.io\n    version: 2.0.2\nEOF\n"})}),"\n",(0,s.jsxs)(t.p,{children:["Let's navigate again the ",(0,s.jsx)(t.code,{children:"compositions"})," page of Krateo 2.5.0 - now the composition ",(0,s.jsx)(t.code,{children:"fireworksapp-tomigrate"})," is migrated:\n",(0,s.jsx)(t.img,{src:"https://github.com/user-attachments/assets/08c6d15f-512c-4e0a-8ed5-edc135057397",alt:"image"})]}),"\n",(0,s.jsxs)(t.p,{children:["Let's navigate the ",(0,s.jsx)(t.code,{children:"fireworksapp-tomigrate"})," composition widgets:\n",(0,s.jsx)(t.img,{src:"https://github.com/user-attachments/assets/ffac1cca-4cd5-474a-b538-2c473c32633f",alt:"image"}),"\n",(0,s.jsx)(t.img,{src:"https://github.com/user-attachments/assets/ae8d8e07-6275-47c6-a996-259e6dda0af6",alt:"image"}),"\n",(0,s.jsx)(t.img,{src:"https://github.com/user-attachments/assets/239320a6-968c-4ccb-a2d8-5d08486d2377",alt:"image"}),"\n",(0,s.jsx)(t.img,{src:"https://github.com/user-attachments/assets/2447f51b-9c1e-4d0c-be0d-8d4e8f9a93c3",alt:"image"}),"\n",(0,s.jsx)(t.img,{src:"https://github.com/user-attachments/assets/c4af4aa6-088c-4576-bc48-5f195c53d5c4",alt:"image"})]}),"\n",(0,s.jsxs)(t.p,{children:["The composition ",(0,s.jsx)(t.code,{children:"fireworksapp-tomigrate"})," has been migrated."]}),"\n",(0,s.jsx)(t.h1,{id:"what-has-changed-in-the-fireworksapp-helm-chart-from-1115-to-202-version",children:"What has changed in the Fireworksapp helm chart from 1.1.15 to 2.0.2 version"}),"\n",(0,s.jsx)(t.p,{children:"We have changed the dependency,"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["from: ",(0,s.jsx)(t.a,{href:"https://github.com/krateoplatformops/krateo-v2-template-fireworksapp/blob/1.1.15/chart/Chart.yaml#L27-L32",children:"https://github.com/krateoplatformops/krateo-v2-template-fireworksapp/blob/1.1.15/chart/Chart.yaml#L27-L32"})]}),"\n",(0,s.jsxs)(t.li,{children:["to: ",(0,s.jsx)(t.a,{href:"https://github.com/krateoplatformops/krateo-v2-template-fireworksapp/blob/2.0.2/chart/Chart.yaml#L20-L24",children:"https://github.com/krateoplatformops/krateo-v2-template-fireworksapp/blob/2.0.2/chart/Chart.yaml#L20-L24"})]}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["We have released a new Helm Chart that collects Krateo 2.5.0 new portal widgets which is called ",(0,s.jsx)(t.code,{children:"composable-portal-starter"}),"."]})]})}function h(e={}){const{wrapper:t}={...(0,o.M)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},2172:(e,t,a)=>{a.d(t,{I:()=>n,M:()=>r});var s=a(1504);const o={},i=s.createContext(o);function r(e){const t=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function n(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),s.createElement(i.Provider,{value:t},e.children)}}}]);