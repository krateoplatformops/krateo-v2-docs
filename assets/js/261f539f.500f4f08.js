"use strict";(self.webpackChunkkrateo_v_2_docs=self.webpackChunkkrateo_v_2_docs||[]).push([[9664],{4488:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>c,contentTitle:()=>r,default:()=>d,frontMatter:()=>s,metadata:()=>n,toc:()=>p});var o=i(7624),a=i(2172);const s={description:"Migrating Krateo PlatformOps from v2.4.3 to v2.5.0 (AKS example)",sidebar_label:"Migrating Krateo PlatformOps from v2.4.3 to v2.5.0 (AKS example)"},r="Migrating Krateo PlatformOps from v2.4.3 to v2.5.0 (AKS example)",n={id:"how-to-guides/migrate-krateo/migrating-from-v2-4-3-to-v2-5-0",title:"Migrating Krateo PlatformOps from v2.4.3 to v2.5.0 (AKS example)",description:"Migrating Krateo PlatformOps from v2.4.3 to v2.5.0 (AKS example)",source:"@site/docs/30-how-to-guides/20-migrate-krateo/10-migrating-from-v2-4-3-to-v2-5-0.md",sourceDirName:"30-how-to-guides/20-migrate-krateo",slug:"/how-to-guides/migrate-krateo/migrating-from-v2-4-3-to-v2-5-0",permalink:"/how-to-guides/migrate-krateo/migrating-from-v2-4-3-to-v2-5-0",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:10,frontMatter:{description:"Migrating Krateo PlatformOps from v2.4.3 to v2.5.0 (AKS example)",sidebar_label:"Migrating Krateo PlatformOps from v2.4.3 to v2.5.0 (AKS example)"},sidebar:"tutorialSidebar",previous:{title:"Installing Krateo PlatformOps using security context",permalink:"/how-to-guides/install-krateo/installing-krateo-with-securitycontext"},next:{title:"Migrating from Crossplane Composition to Helm",permalink:"/how-to-guides/migrate-krateo/migrating-from-crossplane-composition-to-helm"}},c={},p=[{value:"Starting point: Krateo 2.4.3, Fireworksapp compositiondefinition 1.1.15, fireworksapp-tomigrate composition",id:"starting-point-krateo-243-fireworksapp-compositiondefinition-1115-fireworksapp-tomigrate-composition",level:2},{value:"Scale Krateo 2.4.3 core-provider to zero replicas",id:"scale-krateo-243-core-provider-to-zero-replicas",level:3},{value:"Scale Krateo 2.4.3 oasgen-provider to zero replicas",id:"scale-krateo-243-oasgen-provider-to-zero-replicas",level:3},{value:"Ending point: Krateo 2.5.0, Fireworksapp compositiondefinition 2.0.2 (version changed within the same compositiondefinition, previous fireworksapp-tomigrate composition",id:"ending-point-krateo-250-fireworksapp-compositiondefinition-202-version-changed-within-the-same-compositiondefinition-previous-fireworksapp-tomigrate-composition",level:2},{value:"Scale Krateo 2.5.0 core-provider to zero replicas",id:"scale-krateo-250-core-provider-to-zero-replicas",level:3},{value:"Scale Krateo 2.4.3 core-provider to one replica",id:"scale-krateo-243-core-provider-to-one-replica",level:3}];function l(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.M)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.h1,{id:"migrating-krateo-platformops-from-v243-to-v250-aks-example",children:"Migrating Krateo PlatformOps from v2.4.3 to v2.5.0 (AKS example)"}),"\n",(0,o.jsx)(t.p,{children:"Krateo 2.5.0 introduces a new set of manifests to declare widgets in the portal. The difference with the previous version resides in the following:"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:"API orchestration has been decoupled from the data preparation for the portal. This assumption requires implementing a RESTAction that the widget will reference"}),"\n",(0,o.jsx)(t.li,{children:"New widgets are strongly typified, meaning that there is a specific Kind for a particular widget, and properties are expressed in the dedicated CRD"}),"\n"]}),"\n",(0,o.jsx)(t.p,{children:"The schema for widgets until the 2.4.3 version is the following:"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{children:"apiVersion: templates.krateo.io/v1alpha1\nkind: Collection\nspec:\n  type: panel\n  propsRef:\n  widgetsRefs: []\n---\napiVersion: templates.krateo.io/v1alpha1\nkind: Widget\nspec:\n  type:\n  propsRef:\n  app:\n    template:\n  API: []\n  actions: []\n"})}),"\n",(0,o.jsx)(t.p,{children:"The schema for widget from 2.5.0 version is the following:"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{children:"kind: LineChart\napiVersion: widgets.templates.krateo.io/v1beta1\nspec:\n  widgetData:\n  apiRef: \n  widgetDataTemplate: []\n  resourcesRefs: []\n  resourcesRefsTemplate: []\n"})}),"\n",(0,o.jsxs)(t.p,{children:["Updated schemas for the new frontend are collected here: ",(0,o.jsx)(t.a,{href:"https://github.com/krateoplatformops/frontend-chart/tree/main/chart/crds",children:"https://github.com/krateoplatformops/frontend-chart/tree/main/chart/crds"})]}),"\n",(0,o.jsx)(t.h2,{id:"starting-point-krateo-243-fireworksapp-compositiondefinition-1115-fireworksapp-tomigrate-composition",children:"Starting point: Krateo 2.4.3, Fireworksapp compositiondefinition 1.1.15, fireworksapp-tomigrate composition"}),"\n",(0,o.jsx)(t.p,{children:"Krateo 2.4.3 has been installed on AKS in the following way:"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{children:"helm upgrade installer installer \\\n --repo https://charts.krateo.io \\\n --namespace krateo-system \\\n --create-namespace \\\n --set krateoplatformops.service.type=LoadBalancer \\\n --set krateoplatformops.service.externalIpAvailable=true \\\n --install \\\n --version 2.4.3 \\\n --wait\n"})}),"\n",(0,o.jsxs)(t.p,{children:["This is the ",(0,o.jsx)(t.code,{children:"login"})," page of Krateo 2.4.3:\n",(0,o.jsx)(t.img,{alt:"image",src:i(4116).c+"",width:"1904",height:"980"})]}),"\n",(0,o.jsxs)(t.p,{children:["This is the ",(0,o.jsx)(t.code,{children:"dashboard"})," page of an empty Krateo 2.4.3 installation:\n",(0,o.jsx)(t.img,{alt:"image",src:i(6340).c+"",width:"1904",height:"980"})]}),"\n",(0,o.jsxs)(t.p,{children:["Let's apply a Fireworksapp ",(0,o.jsx)(t.code,{children:"compositiondefinition"})," version 1.1.15: ",(0,o.jsx)(t.a,{href:"https://github.com/krateoplatformops/krateo-v2-template-fireworksapp",children:"https://github.com/krateoplatformops/krateo-v2-template-fireworksapp"}),", follow instruction for Krateo version 2.4.3 or lower"]}),"\n",(0,o.jsxs)(t.p,{children:["This is the ",(0,o.jsx)(t.code,{children:"dashboard"})," page of Krateo 2.4.3 installation with the installed ",(0,o.jsx)(t.code,{children:"compositiondefinition"})," with status ",(0,o.jsx)(t.code,{children:"Ready:False"}),":\n",(0,o.jsx)(t.img,{alt:"image",src:i(132).c+"",width:"1912",height:"979"})]}),"\n",(0,o.jsxs)(t.p,{children:["This is the ",(0,o.jsx)(t.code,{children:"dashboard"})," page of Krateo 2.4.3 installation with the install ",(0,o.jsx)(t.code,{children:"compositiondefinition"})," that, after a while,e has status ",(0,o.jsx)(t.code,{children:"Ready:True"}),":\n",(0,o.jsx)(t.img,{alt:"image",src:i(6596).c+"",width:"1912",height:"979"})]}),"\n",(0,o.jsxs)(t.p,{children:["Moving to the ",(0,o.jsx)(t.code,{children:"template"})," page of Krateo 2.4.3 installation, a Card is available:\n",(0,o.jsx)(t.img,{alt:"image",src:i(3956).c+"",width:"1912",height:"979"})]}),"\n",(0,o.jsxs)(t.p,{children:["Let's click on the Card to open the Drawer with the CustomForm:\n",(0,o.jsx)(t.img,{alt:"image",src:i(9900).c+"",width:"1912",height:"979"})]}),"\n",(0,o.jsxs)(t.p,{children:["Let's fill the form:\n",(0,o.jsx)(t.img,{alt:"image",src:i(6328).c+"",width:"1912",height:"979"}),"\n",(0,o.jsx)(t.img,{alt:"image",src:i(8424).c+"",width:"1912",height:"979"})]}),"\n",(0,o.jsxs)(t.p,{children:["Krateo automatically opens the ",(0,o.jsx)(t.code,{children:"compositions"})," page once the ",(0,o.jsx)(t.code,{children:"fireworksapp-tomigrate"})," composition is created:\n",(0,o.jsx)(t.img,{alt:"image",src:i(9716).c+"",width:"1912",height:"979"})]}),"\n",(0,o.jsxs)(t.p,{children:["Let's navigate the ",(0,o.jsx)(t.code,{children:"fireworksapp-tomigrate"})," composition widgets:\n",(0,o.jsx)(t.img,{alt:"image",src:i(6324).c+"",width:"1912",height:"979"}),"\n",(0,o.jsx)(t.img,{alt:"image",src:i(7236).c+"",width:"1912",height:"979"}),"\n",(0,o.jsx)(t.img,{alt:"image",src:i(8540).c+"",width:"1912",height:"979"}),"\n",(0,o.jsx)(t.img,{alt:"image",src:i(7888).c+"",width:"1912",height:"979"}),"\n",(0,o.jsx)(t.img,{alt:"image",src:i(7960).c+"",width:"1912",height:"979"})]}),"\n",(0,o.jsxs)(t.p,{children:["This is the ",(0,o.jsx)(t.code,{children:"dashboard"})," page of Krateo 2.4.3 installation with the installed ",(0,o.jsx)(t.code,{children:"fireworksapp-tomigrate"})," composition:\n",(0,o.jsx)(t.img,{alt:"image",src:i(1372).c+"",width:"1904",height:"975"})]}),"\n",(0,o.jsx)(t.h3,{id:"scale-krateo-243-core-provider-to-zero-replicas",children:"Scale Krateo 2.4.3 core-provider to zero replicas"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-sh",children:"kubectl scale deployment core-provider --replicas=0 -n krateo-system\n"})}),"\n",(0,o.jsx)(t.h3,{id:"scale-krateo-243-oasgen-provider-to-zero-replicas",children:"Scale Krateo 2.4.3 oasgen-provider to zero replicas"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-sh",children:"kubectl scale deployment oasgen-provider --replicas=0 -n krateo-system\n"})}),"\n",(0,o.jsx)(t.h2,{id:"ending-point-krateo-250-fireworksapp-compositiondefinition-202-version-changed-within-the-same-compositiondefinition-previous-fireworksapp-tomigrate-composition",children:"Ending point: Krateo 2.5.0, Fireworksapp compositiondefinition 2.0.2 (version changed within the same compositiondefinition, previous fireworksapp-tomigrate composition"}),"\n",(0,o.jsx)(t.p,{children:"A parallel installation of Krateo 2.5.0 has been installed on AKS in the following way:"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-sh",children:"git clone --branch 249-prepare-release-250 https://github.com/krateoplatformops/installer-chart.git\ncd installer-chart\nhelm install installer-v2 ./chart --namespace krateo-v2-system --create-namespace -f ./chart/values.yaml --wait\n"})}),"\n",(0,o.jsx)(t.h3,{id:"scale-krateo-250-core-provider-to-zero-replicas",children:"Scale Krateo 2.5.0 core-provider to zero replicas"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-sh",children:"kubectl scale deployment core-provider --replicas=0 -n krateo-v2-system\n"})}),"\n",(0,o.jsx)(t.h3,{id:"scale-krateo-243-core-provider-to-one-replica",children:"Scale Krateo 2.4.3 core-provider to one replica"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-sh",children:"kubectl scale deployment core-provider --replicas=1 -n krateo-system\n"})}),"\n",(0,o.jsxs)(t.p,{children:["This is the ",(0,o.jsx)(t.code,{children:"login"})," page of Krateo 2.5.0:\n",(0,o.jsx)(t.img,{alt:"image",src:i(4828).c+"",width:"1912",height:"979"})]}),"\n",(0,o.jsxs)(t.p,{children:["This is the ",(0,o.jsx)(t.code,{children:"dashboard"})," page of a Krateo 2.5.0 installation:\n",(0,o.jsx)(t.img,{alt:"image",src:i(5252).c+"",width:"1904",height:"975"})]}),"\n",(0,o.jsxs)(t.p,{children:["Let's configure Krateo 2.5.0 for Fireworksapp ",(0,o.jsx)(t.code,{children:"compositiondefinition"})," version 2.0.2: ",(0,o.jsx)(t.a,{href:"https://github.com/krateoplatformops/krateo-v2-template-fireworksapp",children:"https://github.com/krateoplatformops/krateo-v2-template-fireworksapp"}),", follow instruction for Krateo >= 2.5.0"]}),"\n",(0,o.jsxs)(t.p,{children:["Let's navigate the ",(0,o.jsx)(t.code,{children:"compositions"})," page of Krateo 2.5.0 - it is empty since the composition ",(0,o.jsx)(t.code,{children:"fireworksapp-tomigrate"})," has not been migrated yet:\n",(0,o.jsx)(t.img,{alt:"image",src:i(4080).c+"",width:"1904",height:"975"})]}),"\n",(0,o.jsxs)(t.p,{children:["Let's migrate the composition, changing the Fireworksapp ",(0,o.jsx)(t.code,{children:"compositiondefinition"})," version from 1.1.15 to 2.0.2:"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-sh",children:"cat <<EOF | kubectl apply -f -\napiVersion: core.krateo.io/v1alpha1\nkind: CompositionDefinition\nmetadata:\n  name: fireworksapp\n  namespace: fireworksapp-system\nspec:\n  chart:\n    repo: fireworks-app\n    url: https://charts.krateo.io\n    version: 2.0.2\nEOF\n"})}),"\n",(0,o.jsxs)(t.p,{children:["Let's navigate again the ",(0,o.jsx)(t.code,{children:"compositions"})," page of Krateo 2.5.0 - now the composition ",(0,o.jsx)(t.code,{children:"fireworksapp-tomigrate"})," is migrated:\n",(0,o.jsx)(t.img,{alt:"image",src:i(5731).c+"",width:"1904",height:"975"})]}),"\n",(0,o.jsxs)(t.p,{children:["Let's navigate the ",(0,o.jsx)(t.code,{children:"fireworksapp-tomigrate"})," composition widgets:\n",(0,o.jsx)(t.img,{alt:"image",src:i(8232).c+"",width:"1904",height:"975"}),"\n",(0,o.jsx)(t.img,{alt:"image",src:i(2356).c+"",width:"1904",height:"975"}),"\n",(0,o.jsx)(t.img,{alt:"image",src:i(4879).c+"",width:"1904",height:"975"}),"\n",(0,o.jsx)(t.img,{alt:"image",src:i(5300).c+"",width:"1904",height:"975"}),"\n",(0,o.jsx)(t.img,{alt:"image",src:i(1620).c+"",width:"1904",height:"975"})]}),"\n",(0,o.jsxs)(t.p,{children:["The composition ",(0,o.jsx)(t.code,{children:"fireworksapp-tomigrate"})," has been migrated."]}),"\n",(0,o.jsx)(t.h1,{id:"what-has-changed-in-the-fireworksapp-helm-chart-from-1115-to-202-version",children:"What has changed in the Fireworksapp helm chart from 1.1.15 to 2.0.2 version"}),"\n",(0,o.jsx)(t.p,{children:"We have changed the dependency,"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsxs)(t.li,{children:["from: ",(0,o.jsx)(t.a,{href:"https://github.com/krateoplatformops/krateo-v2-template-fireworksapp/blob/1.1.15/chart/Chart.yaml#L27-L32",children:"https://github.com/krateoplatformops/krateo-v2-template-fireworksapp/blob/1.1.15/chart/Chart.yaml#L27-L32"})]}),"\n",(0,o.jsxs)(t.li,{children:["to: ",(0,o.jsx)(t.a,{href:"https://github.com/krateoplatformops/krateo-v2-template-fireworksapp/blob/2.0.2/chart/Chart.yaml#L20-L24",children:"https://github.com/krateoplatformops/krateo-v2-template-fireworksapp/blob/2.0.2/chart/Chart.yaml#L20-L24"})]}),"\n"]}),"\n",(0,o.jsxs)(t.p,{children:["We have released a new Helm Chart that collects Krateo 2.5.0 new portal widgets which is called ",(0,o.jsx)(t.code,{children:"composable-portal-starter"}),"."]})]})}function d(e={}){const{wrapper:t}={...(0,a.M)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}},4116:(e,t,i)=>{i.d(t,{c:()=>o});const o=i.p+"assets/images/01_2-4-3-login-c48a55582fa7f2cf52c8c289548a0b0c.png"},6340:(e,t,i)=>{i.d(t,{c:()=>o});const o=i.p+"assets/images/02_2-4-3-dashboard_notemplates-f26bb31034c3b88cb8803fdc25cef8b0.png"},132:(e,t,i)=>{i.d(t,{c:()=>o});const o=i.p+"assets/images/03_2-4-3-dashboard_1template_readyfalse-4333319cd0985045f7af4800c66ee3b4.png"},6596:(e,t,i)=>{i.d(t,{c:()=>o});const o=i.p+"assets/images/04_2-4-3-dashboard_1template_readytrue-b6bd1730e9afb78ddd6df6348a36e17a.png"},3956:(e,t,i)=>{i.d(t,{c:()=>o});const o=i.p+"assets/images/05_2-4-3-templates_1template_readytrue-901dd2b9a14c1c7795a4c3addf62d079.png"},9900:(e,t,i)=>{i.d(t,{c:()=>o});const o=i.p+"assets/images/06_2-4-3-templates_1template_form-153be93396310a9ab77a3bd451d48514.png"},6328:(e,t,i)=>{i.d(t,{c:()=>o});const o=i.p+"assets/images/07_2-4-3-templates_1template_form_filled-fce111347171d8b5fe8ba88140502d2e.png"},8424:(e,t,i)=>{i.d(t,{c:()=>o});const o=i.p+"assets/images/08_2-4-3-templates_1template_form_submitted-c5f8b9c55275c2a3cad0cf509d2a4190.png"},9716:(e,t,i)=>{i.d(t,{c:()=>o});const o=i.p+"assets/images/09_2-4-3-compositions-5c666854fda2f5276d2cd241dd4b8c60.png"},6324:(e,t,i)=>{i.d(t,{c:()=>o});const o=i.p+"assets/images/10_2-4-3-composition_overview-33f25d53c6a5ea99016e66d403ef0b2d.png"},7236:(e,t,i)=>{i.d(t,{c:()=>o});const o=i.p+"assets/images/11_2-4-3-composition_status-ea25d926c6066f1d18fc8230a3a997fe.png"},8540:(e,t,i)=>{i.d(t,{c:()=>o});const o=i.p+"assets/images/12_2-4-3-composition_application-d92fa4034fcc6c7bb1b4f657b31324ed.png"},7888:(e,t,i)=>{i.d(t,{c:()=>o});const o=i.p+"assets/images/13_2-4-3-composition_events-27e5320a4e0fd62dee8a0629b819ef92.png"},7960:(e,t,i)=>{i.d(t,{c:()=>o});const o=i.p+"assets/images/14_2-4-3-composition_values-13879df667e7548399cf7df88bd5c699.png"},1372:(e,t,i)=>{i.d(t,{c:()=>o});const o=i.p+"assets/images/15_2-4-3-dashboard_1template_1composition-f4a29d5291fe545389ee2c726dff5455.png"},4828:(e,t,i)=>{i.d(t,{c:()=>o});const o=i.p+"assets/images/16_2-5-0-login-93a90935e234e6c7238bb09eb5fd57ec.png"},5252:(e,t,i)=>{i.d(t,{c:()=>o});const o=i.p+"assets/images/17_2-5-0-dashboard_1template_1composition-dfc36b5b55eed3ddd0b230578242e6ff.png"},4080:(e,t,i)=>{i.d(t,{c:()=>o});const o=i.p+"assets/images/18_2-5-0-compositions_empty-14afc0afc5bf8d5fc06c043c702aa20f.png"},5731:(e,t,i)=>{i.d(t,{c:()=>o});const o=i.p+"assets/images/19_2-5-0-compositions-ef0ffe2af0c5c11e121357c85cf240d4.png"},8232:(e,t,i)=>{i.d(t,{c:()=>o});const o=i.p+"assets/images/20_2-5-0-composition_overview-f81584cccf1db5750724b5e0b0a2ff5f.png"},2356:(e,t,i)=>{i.d(t,{c:()=>o});const o=i.p+"assets/images/21_2-5-0-composition_status-08d9ae37b6f688a8d1ddadc0b240c55c.png"},4879:(e,t,i)=>{i.d(t,{c:()=>o});const o=i.p+"assets/images/22_2-5-0-composition_application-483db377abd040a5f66202b4e5439b85.png"},5300:(e,t,i)=>{i.d(t,{c:()=>o});const o=i.p+"assets/images/23_2-5-0-composition_events-a376bd5190cad97b1b2f1d2f822b9d4a.png"},1620:(e,t,i)=>{i.d(t,{c:()=>o});const o=i.p+"assets/images/24_2-5-0-composition_values-c4dc191b63652598975eaab58f347e45.png"},2172:(e,t,i)=>{i.d(t,{I:()=>n,M:()=>r});var o=i(1504);const a={},s=o.createContext(a);function r(e){const t=o.useContext(s);return o.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function n(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),o.createElement(s.Provider,{value:t},e.children)}}}]);