"use strict";(self.webpackChunkkrateo_v_2_docs=self.webpackChunkkrateo_v_2_docs||[]).push([[4896],{6920:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>t,default:()=>a,frontMatter:()=>c,metadata:()=>i,toc:()=>o});var d=s(7624),r=s(2172);const c={},t="RESTAction",i={id:"key-concepts/kcp/snowplow-RESTAction",title:"RESTAction",description:"API Group: templates.krateo.io",source:"@site/docs/20-key-concepts/20-kcp/21-snowplow-RESTAction.md",sourceDirName:"20-key-concepts/20-kcp",slug:"/key-concepts/kcp/snowplow-RESTAction",permalink:"/key-concepts/kcp/snowplow-RESTAction",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:21,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"snowplow",permalink:"/key-concepts/kcp/snowplow"},next:{title:"Endpoint",permalink:"/key-concepts/kcp/snowplow-endpoints"}},l={},o=[{value:"Overview",id:"overview",level:2},{value:"<code>spec</code>",id:"spec",level:2},{value:"<code>spec.api[]</code>",id:"specapi",level:3},{value:"<code>spec.api[].endpointRef</code>",id:"specapiendpointref",level:3},{value:"<code>spec.api[].dependsOn</code>",id:"specapidependson",level:3},{value:"Example",id:"example",level:2}];function h(e){const n={a:"a",blockquote:"blockquote",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.M)(),...e.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(n.h1,{id:"restaction",children:(0,d.jsx)(n.code,{children:"RESTAction"})}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.strong,{children:"API Group:"})," ",(0,d.jsx)(n.code,{children:"templates.krateo.io"}),(0,d.jsx)(n.br,{}),"\n",(0,d.jsx)(n.strong,{children:"Kind:"})," ",(0,d.jsx)(n.code,{children:"RESTAction"}),(0,d.jsx)(n.br,{}),"\n",(0,d.jsx)(n.strong,{children:"Version:"})," ",(0,d.jsx)(n.code,{children:"v1"}),(0,d.jsx)(n.br,{}),"\n",(0,d.jsx)(n.strong,{children:"Scope:"})," Namespaced"]}),"\n",(0,d.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,d.jsxs)(n.p,{children:["The ",(0,d.jsx)(n.code,{children:"RESTAction"})," is a Krateo PlatformOps resource that enables users to ",(0,d.jsx)(n.strong,{children:"declaratively define one or more REST API calls"})," within Kubernetes."]}),"\n",(0,d.jsx)(n.p,{children:"It allows you to chain HTTP requests, handle dependencies between them, extract data, and use filters to process results \u2014 all through a Kubernetes-native manifest."}),"\n",(0,d.jsx)(n.p,{children:"This approach is particularly useful for integrating external systems or Kubernetes APIs into workflows managed by Krateo PlatformOps."}),"\n",(0,d.jsxs)(n.blockquote,{children:["\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.code,{children:"RESTAction"})," defines one or more declarative HTTP (REST) calls that can optionally depend on other calls."]}),"\n"]}),"\n",(0,d.jsx)(n.p,{children:"It allows you to orchestrate a chain of API requests across multiple endpoints using Kubernetes resources."}),"\n",(0,d.jsxs)(n.p,{children:["A ",(0,d.jsx)(n.code,{children:"RESTAction"})," resource declaratively defines one or more HTTP calls (",(0,d.jsx)(n.code,{children:"spec.api"}),") that can depend on each other."]}),"\n",(0,d.jsxs)(n.p,{children:["Each call can produce a JSON response that becomes part of a ",(0,d.jsx)(n.strong,{children:"shared global context"}),", enabling subsequent calls to reference previous results using ",(0,d.jsx)(n.strong,{children:"JQ expressions"}),", iterators, and filters."]}),"\n",(0,d.jsxs)(n.p,{children:["To fully leverage these advanced capabilities \u2014 such as resolving JQ expressions, using custom JQ functions or modules, and managing interdependent API calls \u2014 the ",(0,d.jsx)(n.code,{children:"RESTAction"})," must be executed through the ",(0,d.jsx)(n.code,{children:"snowplow"})," service endpoint (",(0,d.jsx)(n.code,{children:"/call"}),")."]}),"\n",(0,d.jsx)(n.p,{children:"Only this endpoint implements the orchestration logic that:"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:["Executes all HTTP requests defined under ",(0,d.jsx)(n.code,{children:"spec.api"}),", respecting their declared dependencies (",(0,d.jsx)(n.code,{children:"dependsOn"}),")."]}),"\n",(0,d.jsx)(n.li,{children:"Stores all API responses in a global JSON context."}),"\n",(0,d.jsx)(n.li,{children:"Evaluates and resolves any JQ expressions or iterators defined within the resource."}),"\n",(0,d.jsxs)(n.li,{children:["Returns the computed output in the resource\u2019s ",(0,d.jsx)(n.code,{children:"status"})," field."]}),"\n"]}),"\n",(0,d.jsxs)(n.p,{children:["When a ",(0,d.jsx)(n.code,{children:"RESTAction"})," is retrieved directly via Kubernetes (e.g. ",(0,d.jsx)(n.code,{children:"kubectl get restaction <name>"}),"), the resource is shown ",(0,d.jsx)(n.strong,{children:"as-is"}),", without JQ resolution or execution of any API calls."]}),"\n",(0,d.jsx)(n.h2,{id:"spec",children:(0,d.jsx)(n.code,{children:"spec"})}),"\n",(0,d.jsxs)(n.p,{children:["The ",(0,d.jsx)(n.code,{children:"spec"})," field defines the configuration for the REST action workflow."]}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Field"}),(0,d.jsx)(n.th,{children:"Type"}),(0,d.jsx)(n.th,{children:"Description"}),(0,d.jsx)(n.th,{children:"Required"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"api"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"array"})}),(0,d.jsx)(n.td,{children:"List of API requests to execute. Each item defines one HTTP call."}),(0,d.jsx)(n.td,{children:"\u2705"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"filter"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"string"})}),(0,d.jsx)(n.td,{children:"Optional filter to apply to the overall output or results."}),(0,d.jsx)(n.td,{children:"\u274c"})]})]})]}),"\n",(0,d.jsx)(n.h3,{id:"specapi",children:(0,d.jsx)(n.code,{children:"spec.api[]"})}),"\n",(0,d.jsx)(n.p,{children:"Defines a single HTTP request and its dependencies."}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Field"}),(0,d.jsx)(n.th,{children:"Type"}),(0,d.jsx)(n.th,{children:"Description"}),(0,d.jsx)(n.th,{children:"Required"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"name"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"string"})}),(0,d.jsx)(n.td,{children:"A unique identifier for this API call."}),(0,d.jsx)(n.td,{children:"\u2705"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"verb"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"string"})}),(0,d.jsxs)(n.td,{children:["The HTTP method (e.g., ",(0,d.jsx)(n.code,{children:"GET"}),", ",(0,d.jsx)(n.code,{children:"POST"}),", ",(0,d.jsx)(n.code,{children:"PUT"}),", ",(0,d.jsx)(n.code,{children:"DELETE"}),"). Defaults to ",(0,d.jsx)(n.code,{children:"GET"}),"."]}),(0,d.jsx)(n.td,{children:"\u274c"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"path"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"string"})}),(0,d.jsx)(n.td,{children:"The URI path of the request."}),(0,d.jsx)(n.td,{children:"\u274c"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"payload"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"string"})}),(0,d.jsxs)(n.td,{children:["The request body (for methods like ",(0,d.jsx)(n.code,{children:"POST"}),", ",(0,d.jsx)(n.code,{children:"PUT"}),", etc.)."]}),(0,d.jsx)(n.td,{children:"\u274c"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"headers"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"array"})}),(0,d.jsx)(n.td,{children:"Array of custom request headers to include in the request."}),(0,d.jsx)(n.td,{children:"\u274c"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"filter"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"string"})}),(0,d.jsx)(n.td,{children:"Optional filter to process or extract data from the response."}),(0,d.jsx)(n.td,{children:"\u274c"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"errorKey"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"string"})}),(0,d.jsx)(n.td,{children:"Key to identify error fields in the response."}),(0,d.jsx)(n.td,{children:"\u274c"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"exportJwt"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"boolean"})}),(0,d.jsxs)(n.td,{children:["If ",(0,d.jsx)(n.code,{children:"true"}),", exports a JWT token from this request for later use."]}),(0,d.jsx)(n.td,{children:"\u274c"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"continueOnError"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"boolean"})}),(0,d.jsxs)(n.td,{children:["If ",(0,d.jsx)(n.code,{children:"true"}),", continues execution even if this call fails."]}),(0,d.jsx)(n.td,{children:"\u274c"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"endpointRef"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"object"})}),(0,d.jsxs)(n.td,{children:["Reference to a Kubernetes ",(0,d.jsx)(n.a,{href:"/key-concepts/kcp/snowplow-endpoints",children:(0,d.jsx)(n.code,{children:"Endpoint"})})," object defining the target service."]}),(0,d.jsx)(n.td,{children:"\u2705"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"dependsOn"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"object"})}),(0,d.jsx)(n.td,{children:"Declares a dependency on another API call defined in this spec."}),(0,d.jsx)(n.td,{children:"\u274c"})]})]})]}),"\n",(0,d.jsx)(n.h3,{id:"specapiendpointref",children:(0,d.jsx)(n.code,{children:"spec.api[].endpointRef"})}),"\n",(0,d.jsxs)(n.p,{children:["Defines the reference to an ",(0,d.jsx)(n.a,{href:"/key-concepts/kcp/snowplow-endpoints",children:(0,d.jsx)(n.code,{children:"Endpoint"})})," resource that this API should call."]}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Field"}),(0,d.jsx)(n.th,{children:"Type"}),(0,d.jsx)(n.th,{children:"Description"}),(0,d.jsx)(n.th,{children:"Required"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"name"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"string"})}),(0,d.jsxs)(n.td,{children:["Name of the referenced ",(0,d.jsx)(n.a,{href:"/key-concepts/kcp/snowplow-endpoints",children:(0,d.jsx)(n.code,{children:"Endpoint"})})," object."]}),(0,d.jsx)(n.td,{children:"\u2705"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"namespace"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"string"})}),(0,d.jsxs)(n.td,{children:["Namespace of the referenced ",(0,d.jsx)(n.a,{href:"/key-concepts/kcp/snowplow-endpoints",children:(0,d.jsx)(n.code,{children:"Endpoint"})})," object."]}),(0,d.jsx)(n.td,{children:"\u2705"})]})]})]}),"\n",(0,d.jsx)(n.h3,{id:"specapidependson",children:(0,d.jsx)(n.code,{children:"spec.api[].dependsOn"})}),"\n",(0,d.jsxs)(n.p,{children:["Defines a dependency on another API call within the same ",(0,d.jsx)(n.code,{children:"RESTAction"})," definition.",(0,d.jsx)(n.br,{}),"\n","Useful for chaining calls where one must complete before another."]}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Field"}),(0,d.jsx)(n.th,{children:"Type"}),(0,d.jsx)(n.th,{children:"Description"}),(0,d.jsx)(n.th,{children:"Required"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"name"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"string"})}),(0,d.jsx)(n.td,{children:"Name of another API call in the list that this call depends on."}),(0,d.jsx)(n.td,{children:"\u2705"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"iterator"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"string"})}),(0,d.jsx)(n.td,{children:"Optional field on which to iterate (used for loop-like behavior)."}),(0,d.jsx)(n.td,{children:"\u274c"})]})]})]}),"\n",(0,d.jsx)(n.h2,{id:"example",children:"Example"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-yaml",children:'apiVersion: templates.krateo.io/v1\nkind: RESTAction\nmetadata:\n  name: example-restaction\nspec:\n  api:\n    - name: get-user\n      endpointRef:\n        name: user-endpoint\n        namespace: default\n      verb: GET\n      path: /users\n      headers:\n        - "Authorization: Bearer $(TOKEN)"\n      continueOnError: false\n\n    - name: update-user\n      dependsOn:\n        name: get-user\n      endpointRef:\n        name: user-endpoint\n        namespace: default\n      verb: PUT\n      path: /users/123\n      payload: \'{"status":"active"}\'\n\n  filter: ""\n'})})]})}function a(e={}){const{wrapper:n}={...(0,r.M)(),...e.components};return n?(0,d.jsx)(n,{...e,children:(0,d.jsx)(h,{...e})}):h(e)}},2172:(e,n,s)=>{s.d(n,{I:()=>i,M:()=>t});var d=s(1504);const r={},c=d.createContext(r);function t(e){const n=d.useContext(c);return d.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),d.createElement(c.Provider,{value:n},e.children)}}}]);