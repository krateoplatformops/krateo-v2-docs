"use strict";(self.webpackChunkkrateo_v_2_docs=self.webpackChunkkrateo_v_2_docs||[]).push([[540],{9740:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>r,default:()=>p,frontMatter:()=>i,metadata:()=>o,toc:()=>c});var t=s(7624),a=s(2172);const i={},r="frontend",o={id:"key-concepts/kcp/frontend",title:"frontend",description:"In the Krateo Composable Portal, everything is built around the concept of widgets and their composition. A widget is a Kubernetes Custom Resource Definition (CRD) that is mapped either to a UI element rendered in the frontend (for example, a Button) or to a configuration object used by other widgets (for example, a Route).",source:"@site/docs/20-key-concepts/20-kcp/10-frontend.md",sourceDirName:"20-key-concepts/20-kcp",slug:"/key-concepts/kcp/frontend",permalink:"/key-concepts/kcp/frontend",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:10,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"provider-runtime",permalink:"/key-concepts/kco/provider-runtime"},next:{title:"frontend-widget-api-reference",permalink:"/key-concepts/kcp/frontend-widget-api-reference"}},d={},c=[{value:"Anatomy of a Widget",id:"anatomy-of-a-widget",level:2},{value:"<code>widgetData</code>",id:"widgetdata",level:2},{value:"<code>widgetDataTemplate</code>",id:"widgetdatatemplate",level:2},{value:"Simple Example",id:"simple-example",level:3},{value:"Complete Example",id:"complete-example",level:3},{value:"How It Works",id:"how-it-works",level:3},{value:"<code>actions</code>",id:"actions",level:2},{value:"Composing Widgets",id:"composing-widgets",level:2},{value:"<code>resourcesRefs</code>",id:"resourcesrefs",level:3},{value:"<code>resourcesRefsTemplate</code>",id:"resourcesrefstemplate",level:3}];function l(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.M)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"frontend",children:"frontend"}),"\n",(0,t.jsxs)(n.p,{children:["In the Krateo Composable Portal, everything is built around the concept of ",(0,t.jsx)(n.strong,{children:"widgets"})," and their composition. A widget is a Kubernetes ",(0,t.jsx)(n.strong,{children:"Custom Resource Definition (CRD)"})," that is mapped either to a UI element rendered in the frontend (for example, a ",(0,t.jsx)(n.code,{children:"Button"}),") or to a configuration object used by other widgets (for example, a ",(0,t.jsx)(n.code,{children:"Route"}),")."]}),"\n",(0,t.jsxs)(n.p,{children:["A complete list of available widgets and their properties is available in the ",(0,t.jsx)(n.a,{href:"/key-concepts/kcp/frontend-widget-api-reference",children:"Widgets API Reference"}),"."]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"anatomy-of-a-widget",children:"Anatomy of a Widget"}),"\n",(0,t.jsxs)(n.p,{children:["Each widget is defined by a ",(0,t.jsx)(n.strong,{children:"JSON Schema"}),", which acts as its single source of truth. This schema is used to generate the corresponding CRD and enables schema validation at apply time."]}),"\n",(0,t.jsxs)(n.p,{children:["As a result, every widget has its own ",(0,t.jsx)(n.code,{children:"kind"})," and a well-defined structure."]}),"\n",(0,t.jsxs)(n.p,{children:["You can find an example of a widget schema in the ",(0,t.jsx)(n.a,{href:"https://github.com/krateoplatformops/frontend/blob/9238f66eee8ff92fa85320edff90354e280a5488/src/widgets/Button/Button.schema.json",children:"Button widget JSON schema"}),"."]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"widgetdata",children:(0,t.jsx)(n.code,{children:"widgetData"})}),"\n",(0,t.jsxs)(n.p,{children:["Every widget defines a ",(0,t.jsx)(n.code,{children:"spec.widgetData"})," field, which contains the data that controls how the widget looks and behaves in the Composable Portal."]}),"\n",(0,t.jsxs)(n.p,{children:["For example, in a ",(0,t.jsx)(n.code,{children:"Button"})," widget, properties such as ",(0,t.jsx)(n.code,{children:"label"}),", ",(0,t.jsx)(n.code,{children:"icon"})," (using the ",(0,t.jsx)(n.a,{href:"https://fontawesome.com/search?ip=classic&s=solid&o=r",children:"Font Awesome"})," naming convention), and ",(0,t.jsx)(n.code,{children:"type"})," determine the visual appearance of the button. All supported configuration options for each widget are documented in the ",(0,t.jsx)(n.a,{href:"/key-concepts/kcp/frontend-widget-api-reference",children:"Widgets API Reference"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["Below is a minimal example of a ",(0,t.jsx)(n.code,{children:"Button"})," widget:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"kind: Button\napiVersion: widgets.templates.krateo.io/v1beta1\nmetadata:\n  name: button-1\n  namespace: krateo-system\nspec:\n  widgetData:\n    label: This is a button\n    icon: fa-sun\n    type: primary\n    clickActionId: navigate-example-button-page\n    actions:\n      navigate:\n        - id: navigate-example-button-page\n          path: /button\n          type: navigate\n  resourcesRefs:\n    items:\n      - id: navigate-example-button-page\n        apiVersion: widgets.templates.krateo.io/v1beta1\n        name: example-button-page\n        namespace: krateo-system\n        resource: pages\n        verb: GET\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"widgetdatatemplate",children:(0,t.jsx)(n.code,{children:"widgetDataTemplate"})}),"\n",(0,t.jsxs)(n.p,{children:["Every widget also supports the optional ",(0,t.jsx)(n.code,{children:"spec.widgetDataTemplate"})," field. This field allows you to ",(0,t.jsx)(n.strong,{children:"override or populate specific values"})," defined in ",(0,t.jsx)(n.code,{children:"spec.widgetData"})," with dynamic data at runtime."]}),"\n",(0,t.jsx)(n.p,{children:"This mechanism is particularly useful for injecting data coming from APIs into widgets."}),"\n",(0,t.jsxs)(n.p,{children:["A ",(0,t.jsx)(n.code,{children:"widgetDataTemplate"})," is an array of objects with the following keys:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"forPath"})}),": the path of the field in ",(0,t.jsx)(n.code,{children:"widgetData"})," to override, using dot notation (for example, ",(0,t.jsx)(n.code,{children:"parentProperty.childProperty"}),")."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"expression"})}),": a ",(0,t.jsx)(n.a,{href:"https://jqlang.org/",children:"jq"})," expression whose result will be injected into the specified path."]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Example structure:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"widgetDataTemplate:\n  - forPath: data\n    expression: ${ .namespaces }\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"simple-example",children:"Simple Example"}),"\n",(0,t.jsx)(n.p,{children:"In the following example, the label of the button is dynamically set to the current date when the widget is loaded:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:'kind: Button\napiVersion: widgets.templates.krateo.io/v1beta1\nmetadata:\n  name: button-1\n  namespace: krateo-system\nspec:\n  widgetData:\n    label: This is a button\n    icon: fa-sun\n    type: primary\n    clickActionId: navigate-example-button-page\n    actions:\n      navigate:\n        - id: navigate-example-button-page\n          path: /button\n          type: navigate\n  widgetDataTemplate:\n    - forPath: label\n      expression: ${ now | strftime("%Y-%m-%d") }\n  resourcesRefs:\n    items:\n      - id: navigate-example-button-page\n        apiVersion: widgets.templates.krateo.io/v1beta1\n        name: example-button-page\n        namespace: krateo-system\n        resource: pages\n        verb: GET\n'})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"complete-example",children:"Complete Example"}),"\n",(0,t.jsxs)(n.p,{children:["The following example shows a ",(0,t.jsx)(n.code,{children:"Table"})," widget whose data is dynamically populated from the Kubernetes API:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:'kind: Table\napiVersion: widgets.templates.krateo.io/v1beta1\nmetadata:\n  name: table-of-namespaces\n  namespace: krateo-system\nspec:\n  widgetData:\n    allowedResources: []\n    pageSize: 10\n    data: []\n    columns:\n      - valueKey: name\n        title: Cluster Namespaces\n\n  widgetDataTemplate:\n    - forPath: data\n      expression: ${ .namespaces }\n  apiRef:\n    name: cluster-namespaces\n    namespace: krateo-system\n\n---\napiVersion: templates.krateo.io/v1\nkind: RESTAction\nmetadata:\n  name: cluster-namespaces\n  namespace: krateo-system\nspec:\n  api:\n    - name: namespaces\n      path: "/api/v1/namespaces"\n      filter: "[.items[] | {name: .metadata.name}]"\n'})}),"\n",(0,t.jsxs)(n.p,{children:["In this example, the table defines a single column (",(0,t.jsx)(n.code,{children:"name"}),") and displays all namespaces in the cluster. The data is retrieved directly from the Kubernetes API server."]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"how-it-works",children:"How It Works"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"widgetDataTemplate:\n  - forPath: data\n    expression: ${ .namespaces }\n"})}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:".namespaces"})," reference corresponds to the output of an API named ",(0,t.jsx)(n.code,{children:"namespaces"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"Table"})," widget defines a ",(0,t.jsx)(n.code,{children:"spec.apiRef"})," field that references a ",(0,t.jsx)(n.code,{children:"RESTAction"})," resource by name (",(0,t.jsx)(n.code,{children:"cluster-namespaces"}),"). That ",(0,t.jsx)(n.code,{children:"RESTAction"})," declares an API named ",(0,t.jsx)(n.code,{children:"namespaces"})," inside its ",(0,t.jsx)(n.code,{children:"spec.api"})," list."]}),"\n",(0,t.jsx)(n.p,{children:"Through this chain of references:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Widget \u2192 apiRef \u2192 RESTAction \u2192 api\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"widgetDataTemplate"})," can access the API result by name and inject it into ",(0,t.jsx)(n.code,{children:"widgetData"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["The REST endpoint ",(0,t.jsx)(n.code,{children:"/api/v1/namespaces"})," is served by the Kubernetes API server. If an absolute URL were used instead, the same mechanism could be applied to external APIs. For more details, see the ",(0,t.jsx)(n.a,{href:"https://github.com/krateoplatformops/frontend/blob/9238f66eee8ff92fa85320edff90354e280a5488/docs/restactions.md",children:"RESTActions documentation"}),"."]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"actions",children:(0,t.jsx)(n.code,{children:"actions"})}),"\n",(0,t.jsx)(n.p,{children:"Actions define widget behavior and user interactions."}),"\n",(0,t.jsx)(n.p,{children:"The currently supported actions are:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"rest"})}),": triggers an HTTP request to a referenced resource"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"navigate"})}),": navigates to a different route or referenced resource"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"openDrawer"})}),": displays another widget inside a drawer (side panel)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"openModal"})}),": displays another widget inside a modal"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["Actions are defined inside ",(0,t.jsx)(n.code,{children:"widgetData"}),". A complete list of widgets supporting actions and their available properties can be found in the ",(0,t.jsx)(n.a,{href:"/key-concepts/kcp/frontend-widget-api-reference",children:"Widgets API Reference"}),"."]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"composing-widgets",children:"Composing Widgets"}),"\n",(0,t.jsxs)(n.p,{children:["To build complex and powerful UIs, widgets must be able to reference other widgets and ",(0,t.jsx)(n.code,{children:"RESTAction"}),"s. This is achieved through the ",(0,t.jsx)(n.code,{children:"spec.resourcesRefs"})," field."]}),"\n",(0,t.jsx)(n.h3,{id:"resourcesrefs",children:(0,t.jsx)(n.code,{children:"resourcesRefs"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"kind: Row\napiVersion: widgets.templates.krateo.io/v1beta1\nmetadata:\n  name: my-row\n  namespace: krateo-system\nspec:\n  widgetData:\n    allowedResources: [tables, piecharts]\n    items:\n      - resourceRefId: pie-chart-inside-column\n        size: 6\n      - resourceRefId: table-of-pods\n        size: 18\n  resourcesRefs:\n    items:\n      - id: table-of-pods\n        apiVersion: widgets.templates.krateo.io/v1beta1\n        name: table-of-pods\n        namespace: krateo-system\n        resource: tables\n        verb: GET\n      - id: pie-chart-inside-column\n        apiVersion: widgets.templates.krateo.io/v1beta1\n        name: pie-chart-inside-column\n        namespace: krateo-system\n        resource: piecharts\n        verb: GET\n"})}),"\n",(0,t.jsxs)(n.p,{children:["In this example, ",(0,t.jsx)(n.code,{children:"resourcesRefs"})," declares a list of referenced resources, each associated with a user-defined ",(0,t.jsx)(n.code,{children:"id"}),". The ",(0,t.jsx)(n.code,{children:"Row"})," widget uses these IDs to resolve and render its children."]}),"\n",(0,t.jsxs)(n.p,{children:["The rendering order is determined by the order of the ",(0,t.jsx)(n.code,{children:"items"})," list in ",(0,t.jsx)(n.code,{children:"widgetData"}),", not by the order of ",(0,t.jsx)(n.code,{children:"resourcesRefs"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["Some widgets can be used to build complex layouts. To learn more, please check ",(0,t.jsx)(n.a,{href:"https://github.com/krateoplatformops/frontend/blob/9238f66eee8ff92fa85320edff90354e280a5488/docs/guides/layout/layout.md",children:"this guide"}),"."]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"resourcesrefstemplate",children:(0,t.jsx)(n.code,{children:"resourcesRefsTemplate"})}),"\n",(0,t.jsxs)(n.p,{children:["Similar to ",(0,t.jsx)(n.code,{children:"widgetDataTemplate"}),", ",(0,t.jsx)(n.code,{children:"resourcesRefsTemplate"})," allows ",(0,t.jsx)(n.code,{children:"resourcesRefs"})," to be populated dynamically using data returned by an API."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"kind: Row\napiVersion: widgets.templates.krateo.io/v1beta1\nmetadata:\n  name: templates-row\n  namespace: my-namespace\nspec:\n  apiRef:\n    name: templates-panels\n    namespace: my-namespace\n  widgetData:\n    allowedResources: []\n    items: []\n  widgetDataTemplate:\n    - forPath: items\n      expression: >\n        ${ [ .templatespanels[] | { resourceRefId: .metadata.name, size: 12 } ] }\n  resourcesRefs:\n    items: []\n  resourcesRefsTemplate:\n    - iterator: ${ .templatespanels }\n      template:\n        id: ${ .metadata.name }\n        apiVersion: ${ .apiVersion }\n        resource: panels\n        namespace: ${ .metadata.namespace }\n        name: ${ .metadata.name }\n        verb: GET\n"})}),"\n",(0,t.jsx)(n.p,{children:"In this example:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["the widget references a ",(0,t.jsx)(n.code,{children:"RESTAction"})," named ",(0,t.jsx)(n.code,{children:"templates-panels"})," via ",(0,t.jsx)(n.code,{children:"apiRef"})]}),"\n",(0,t.jsxs)(n.li,{children:["the ",(0,t.jsx)(n.code,{children:"RESTAction"})," exposes an API named ",(0,t.jsx)(n.code,{children:"templatespanels"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"resourcesRefsTemplate"})," iterates over the API result and dynamically generates ",(0,t.jsx)(n.code,{children:"resourcesRefs"})]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["If ",(0,t.jsx)(n.code,{children:"resourcesRefs"})," also contains statically defined entries, they are merged with the dynamically generated ones."]})]})}function p(e={}){const{wrapper:n}={...(0,a.M)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},2172:(e,n,s)=>{s.d(n,{I:()=>o,M:()=>r});var t=s(1504);const a={},i=t.createContext(a);function r(e){const n=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);