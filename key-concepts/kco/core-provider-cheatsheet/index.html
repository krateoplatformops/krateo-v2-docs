<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-key-concepts/kco/core-provider-cheatsheet" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">core-provider-cheatsheet | Krateo PlatformOps Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://docs.krateo.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://docs.krateo.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://docs.krateo.io/key-concepts/kco/core-provider-cheatsheet"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="core-provider-cheatsheet | Krateo PlatformOps Docs"><meta data-rh="true" name="description" content="Comprehensive Deployment Guide with Expected Outcomes"><meta data-rh="true" property="og:description" content="Comprehensive Deployment Guide with Expected Outcomes"><link data-rh="true" rel="icon" href="/img/favicon_io/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.krateo.io/key-concepts/kco/core-provider-cheatsheet"><link data-rh="true" rel="alternate" href="https://docs.krateo.io/key-concepts/kco/core-provider-cheatsheet" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.krateo.io/key-concepts/kco/core-provider-cheatsheet" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.6738e5fb.css">
<script src="/assets/js/runtime~main.ab87e3a4.js" defer="defer"></script>
<script src="/assets/js/main.56204778.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" target="_self" href="/"><div class="navbar__logo"><img src="/img/black-horizontal.svg" alt="Krateo PlatformOps Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/white-horizontal.svg" alt="Krateo PlatformOps Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Docs</b></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/krateoplatformops/krateo" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://killercoda.com/krateoplatformops/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Krateo Free Self-Service Labs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/key-concepts/kco/core-provider">Key Concepts</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/key-concepts/kco/core-provider">Krateo Composable Operations</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/key-concepts/kco/core-provider">core-provider</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/key-concepts/kco/core-provider-cheatsheet">core-provider-cheatsheet</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/key-concepts/kco/composition-dynamic-controller">composition-dynamic-controller</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/key-concepts/kco/provider-runtime">provider-runtime</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/key-concepts/kcp/frontend">Krateo Composable Portal</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/key-concepts/kcf/finops-introduction">Krateo Composable FinOps</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/key-concepts/kog/oasgen-provider">Krateo Operator Generator</a></div></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/quickstart">Quickstart</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/how-to-guides/install-krateo/installing-krateo-kind">How-to guides</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/core-crd-reference/core-provider-crd">Krateo CRD Reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/provider-crd-reference/azuredevops-provider-crd">Provider CRD Reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/provider-reference/github-provider-kog">Provider Reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/release-notes/release-note-2-5-0">Release Notes</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Key Concepts</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Krateo Composable Operations</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">core-provider-cheatsheet</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>core-provider-cheatsheet</h1>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="comprehensive-deployment-guide-with-expected-outcomes">Comprehensive Deployment Guide with Expected Outcomes<a href="#comprehensive-deployment-guide-with-expected-outcomes" class="hash-link" aria-label="Direct link to Comprehensive Deployment Guide with Expected Outcomes" title="Direct link to Comprehensive Deployment Guide with Expected Outcomes">​</a></h2>
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#prerequisites">Prerequisites</a>
<ul>
<li><a href="#initial-setup">Initial Setup</a></li>
<li><a href="#core-platform-installation">Core Platform Installation</a></li>
<li><a href="#compositiondefinition-deployment">CompositionDefinition Deployment</a></li>
<li><a href="#creating-compositions">Creating Compositions</a></li>
<li><a href="#advanced-operations">Advanced Operations</a>
<ul>
<li><a href="#1-deploying-multiple-versions">1. Deploying Multiple Versions</a></li>
<li><a href="#2-upgrading-compositions-massive-migration">2. Upgrading Compositions (massive migration)</a></li>
<li><a href="#3-upgrading-compositions-with-changes-in-the-valuesschemajson">3. Upgrading Compositions with changes in the <code>values.schema.json</code></a></li>
<li><a href="#4-pausing-composition-reconciliation">4. Pausing Composition Reconciliation</a></li>
<li><a href="#5-pausing-composition-gracefully">5. Pausing Composition Gracefully</a></li>
<li><a href="#6-safely-deleting-compositions">6. Safely Deleting Compositions</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#troubleshooting-guide">Troubleshooting Guide</a>
<ul>
<li><a href="#common-issues-and-diagnostic-procedures">Common Issues and Diagnostic Procedures</a>
<ul>
<li><a href="#1-compositiondefinition-not-becoming-ready">1. CompositionDefinition Not Becoming Ready</a></li>
<li><a href="#2-compositions-failing-to-deploy">2. Compositions Failing to Deploy</a></li>
<li><a href="#3-upgraderollback-failures">3. Upgrade/Rollback Failures</a></li>
<li><a href="#4-certificate-issues-mutating-webhook-configuration">4. Certificate Issues: Mutating Webhook Configuration</a></li>
<li><a href="#41-certificate-issues-conversion-webhook-configuration">4.1 Certificate Issues: Conversion Webhook Configuration</a></li>
<li><a href="#5-error-after-creating-compositiondefinition">5. Error after creating CompositionDefinition</a></li>
</ul>
</li>
<li><a href="#general-diagnostic-tools">General Diagnostic Tools</a></li>
<li><a href="#common-solutions">Common Solutions</a></li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction">​</a></h2>
<p>The Krateo V2 Template Fireworks App provides a complete solution for deploying and managing fireworks applications on Kubernetes using Krateo&#x27;s Composition system. This guide covers the entire lifecycle from initial deployment to advanced management scenarios.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="prerequisites">Prerequisites<a href="#prerequisites" class="hash-link" aria-label="Direct link to Prerequisites" title="Direct link to Prerequisites">​</a></h2>
<p>Before beginning, ensure you have:</p>
<ul>
<li>A Kubernetes cluster (v1.20+ recommended)</li>
<li>Helm installed (v3.0+)</li>
<li>kubectl configured to access your cluster</li>
<li>A GitHub account with repository creation permissions</li>
<li>A GitHub personal access token with repo scope</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="initial-setup">Initial Setup<a href="#initial-setup" class="hash-link" aria-label="Direct link to Initial Setup" title="Direct link to Initial Setup">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="1-adding-krateo-helm-repository">1. Adding Krateo Helm Repository<a href="#1-adding-krateo-helm-repository" class="hash-link" aria-label="Direct link to 1. Adding Krateo Helm Repository" title="Direct link to 1. Adding Krateo Helm Repository">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">helm repo add krateo https://charts.krateo.io</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>What to Expect:</strong></p>
<ul>
<li>The command will register Krateo&#x27;s chart repository with your local Helm installation</li>
<li>Upon success, you&#x27;ll see confirmation that &quot;krateo&quot; was added to your repositories</li>
<li>This enables you to install Krateo charts using the <code>krateo/</code> prefix</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="2-updating-helm-repositories">2. Updating Helm Repositories<a href="#2-updating-helm-repositories" class="hash-link" aria-label="Direct link to 2. Updating Helm Repositories" title="Direct link to 2. Updating Helm Repositories">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">helm repo update krateo</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>What&#x27;s Happening:</strong></p>
<ul>
<li>Helm contacts the repository URL to fetch the latest chart information</li>
<li>It updates the local cache of available charts and versions</li>
<li>The success message indicates you now have access to the most recent charts</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="core-platform-installation">Core Platform Installation<a href="#core-platform-installation" class="hash-link" aria-label="Direct link to Core Platform Installation" title="Direct link to Core Platform Installation">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="3-installing-krateo-platform">3. Installing Krateo Platform<a href="#3-installing-krateo-platform" class="hash-link" aria-label="Direct link to 3. Installing Krateo Platform" title="Direct link to 3. Installing Krateo Platform">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">helm upgrade installer installer \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --repo https://charts.krateo.io \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --namespace krateo-system \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --create-namespace \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --install \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --version 2.4.2 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --wait</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Expected Behavior:</strong></p>
<ul>
<li>Helm will create the krateo-system namespace if it doesn&#x27;t exist</li>
<li>The installer chart (version 2.4.2) will be deployed</li>
<li>The --wait flag ensures command completes only when resources are ready</li>
<li>Output shows deployment status and namespace information</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="4-verifying-platform-readiness">4. Verifying Platform Readiness<a href="#4-verifying-platform-readiness" class="hash-link" aria-label="Direct link to 4. Verifying Platform Readiness" title="Direct link to 4. Verifying Platform Readiness">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl wait krateoplatformops krateo --for condition=Ready=True --namespace krateo-system --timeout=660s</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>What This Does:</strong></p>
<ul>
<li>Polls the Krateo platform status until &quot;Ready&quot; condition is True</li>
<li>Times out after 660 seconds if not ready</li>
<li>Successful output means core components are operational</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="5-install-required-providers">5. Install required providers:<a href="#5-install-required-providers" class="hash-link" aria-label="Direct link to 5. Install required providers:" title="Direct link to 5. Install required providers:">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">helm install github-provider krateo/github-provider --namespace krateo-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">helm install git-provider krateo/git-provider --namespace krateo-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">helm install argocd argo/argo-cd --namespace krateo-system --create-namespace --wait</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>These installations set up the necessary providers for GitHub and ArgoCD, enabling integration with your deployment process of the fireworks application.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="compositiondefinition-deployment">CompositionDefinition Deployment<a href="#compositiondefinition-deployment" class="hash-link" aria-label="Direct link to CompositionDefinition Deployment" title="Direct link to CompositionDefinition Deployment">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="1-creating-the-application-namespace">1. Creating the Application Namespace<a href="#1-creating-the-application-namespace" class="hash-link" aria-label="Direct link to 1. Creating the Application Namespace" title="Direct link to 1. Creating the Application Namespace">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl create namespace fireworksapp-system</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Expected Outcome:</strong></p>
<ul>
<li>Creates a dedicated namespace for your Fireworks App resources</li>
<li>Isolates your application resources from other deployments</li>
<li>Simple confirmation message shows creation success</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="2-deploying-the-compositiondefinition">2. Deploying the CompositionDefinition<a href="#2-deploying-the-compositiondefinition" class="hash-link" aria-label="Direct link to 2. Deploying the CompositionDefinition" title="Direct link to 2. Deploying the CompositionDefinition">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat &lt;&lt;EOF | kubectl apply -f -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: core.krateo.io/v1alpha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: CompositionDefinition</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: fireworksapp-cd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  namespace: fireworksapp-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  chart:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    repo: fireworks-app</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    url: https://charts.krateo.io</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    version: 1.1.13</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>What Happens Next:</strong></p>
<ul>
<li>Krateo processes the definition and generates a Custom Resource Definition (CRD)</li>
<li>A dedicated controller pod is deployed to manage compositions</li>
<li>The system prepares to accept FireworksApp custom resources</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="3-verifying-compositiondefinition-status">3. Verifying CompositionDefinition Status<a href="#3-verifying-compositiondefinition-status" class="hash-link" aria-label="Direct link to 3. Verifying CompositionDefinition Status" title="Direct link to 3. Verifying CompositionDefinition Status">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl wait compositiondefinition fireworksapp-cd --for condition=Ready=True --namespace fireworksapp-system --timeout=600s</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>System Behavior:</strong></p>
<ul>
<li>Command waits until the CompositionDefinition is fully processed</li>
<li>During this time, Krateo is setting up the necessary controllers</li>
<li>Success means you can now create FireworksApp instances</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="creating-compositions">Creating Compositions<a href="#creating-compositions" class="hash-link" aria-label="Direct link to Creating Compositions" title="Direct link to Creating Compositions">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="1-setting-up-github-credentials">1. Setting Up GitHub Credentials<a href="#1-setting-up-github-credentials" class="hash-link" aria-label="Direct link to 1. Setting Up GitHub Credentials" title="Direct link to 1. Setting Up GitHub Credentials">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl create secret generic github-repo-creds \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --namespace krateo-system \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --from-literal=token=YOUR_GITHUB_TOKEN</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Why This Matters:</strong></p>
<ul>
<li>Stores your GitHub token securely in the cluster</li>
<li>Enables the system to interact with your repositories</li>
<li>The secret will be referenced by compositions for Git operations</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="3-creating-the-fireworksapp-instance">3. Creating the FireworksApp Instance<a href="#3-creating-the-fireworksapp-instance" class="hash-link" aria-label="Direct link to 3. Creating the FireworksApp Instance" title="Direct link to 3. Creating the FireworksApp Instance">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat &lt;&lt;EOF | kubectl apply -f -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: composition.krateo.io/v1-1-13</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: FireworksApp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: fireworksapp-composition-1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  namespace: fireworksapp-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  app:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    service:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      port: 31180</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      type: NodePort</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  argocd:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    application:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      destination:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        namespace: fireworks-app</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        server: https://kubernetes.default.svc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      project: default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      source:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        path: chart/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      syncPolicy:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        automated:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          prune: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          selfHeal: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    namespace: krateo-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  git:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fromRepo:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      branch: main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      credentials:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        authMethod: generic</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        secretRef:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          key: token</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          name: github-repo-creds</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          namespace: krateo-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      name: krateo-v2-template-fireworksapp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      org: krateoplatformops</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      path: skeleton/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      scmUrl: https://github.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    insecure: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    toRepo:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      apiUrl: https://api.github.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      branch: main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      credentials:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        authMethod: generic</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        secretRef:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          key: token</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          name: github-repo-creds</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          namespace: krateo-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      initialize: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      org: your-organization</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      name: fireworksapp-test-v2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      path: /</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      private: false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      scmUrl: https://github.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    unsupportedCapabilities: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>What Occurs:</strong></p>
<ul>
<li>Krateo creates a new FireworksApp resource</li>
<li>The controller begins provisioning the application</li>
<li>ArgoCD is configured to manage the deployment</li>
<li>A new GitHub repository is created (if specified)</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="4-monitoring-composition-progress">4. Monitoring Composition Progress<a href="#4-monitoring-composition-progress" class="hash-link" aria-label="Direct link to 4. Monitoring Composition Progress" title="Direct link to 4. Monitoring Composition Progress">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl wait fireworksapp fireworksapp-composition-1 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --for condition=Ready=True \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --timeout=300s \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --namespace fireworksapp-system</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Expected Workflow:</strong></p>
<ul>
<li>Command waits until all resources are provisioned</li>
<li>During this time, containers are pulled and started</li>
<li>Services are created and become accessible</li>
<li>Success means your application is fully deployed</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="5-check-helm-release-status">5. Check Helm Release Status<a href="#5-check-helm-release-status" class="hash-link" aria-label="Direct link to 5. Check Helm Release Status" title="Direct link to 5. Check Helm Release Status">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">helm list -n fireworksapp-system</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>What to Expect:</strong></p>
<ul>
<li>Helm lists all releases in the <code>fireworksapp-system</code> namespace</li>
<li>You should see the <code>fireworksapp-composition-1</code> release with version 1.1.13</li>
<li>This confirms that the Helm chart was successfully deployed</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="advanced-operations">Advanced Operations<a href="#advanced-operations" class="hash-link" aria-label="Direct link to Advanced Operations" title="Direct link to Advanced Operations">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="1-deploying-multiple-versions">1. Deploying Multiple Versions<a href="#1-deploying-multiple-versions" class="hash-link" aria-label="Direct link to 1. Deploying Multiple Versions" title="Direct link to 1. Deploying Multiple Versions">​</a></h4>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="scenario">Scenario:<a href="#scenario" class="hash-link" aria-label="Direct link to Scenario:" title="Direct link to Scenario:">​</a></h5>
<p>You need to run two different versions of the same application simultaneously for testing purposes.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat &lt;&lt;EOF | kubectl apply -f -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: core.krateo.io/v1alpha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: CompositionDefinition</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: fireworksapp-cd-v2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  namespace: fireworksapp-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  chart:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    repo: fireworks-app</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    url: https://charts.krateo.io</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    version: 1.1.14</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>System Response:</strong></p>
<ul>
<li>A second controller is deployed for the new version</li>
<li>Both versions can operate simultaneously</li>
<li>Each version maintains its own CRD and controller</li>
</ul>
<p>This will create a new <code>CompositionDefinition</code> named <code>fireworksapp-cd-v2</code> in the <code>fireworksapp-system</code> namespace, which will manage resources of version 1.1.14 of the fireworksapp chart.
You can then deploy the new version of the chart by applying the <code>CompositionDefinition</code> manifest. The <code>core-provider</code> will add a new version to the existing CRD <code>fireworksapps.composition.krateo.io</code> and deploy a new instance of the <code>composition-dynamic-controller</code> to manage resources of version 1.1.14.
The <code>core-provider</code> will leave the previous version of the chart (1.1.13) running along with its associated <code>composition-dynamic-controller</code> instance. This allows you to run multiple versions of the same application simultaneously, each managed by its own <code>composition-dynamic-controller</code>.</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="verifying-compositiondefinition-status">Verifying CompositionDefinition Status<a href="#verifying-compositiondefinition-status" class="hash-link" aria-label="Direct link to Verifying CompositionDefinition Status" title="Direct link to Verifying CompositionDefinition Status">​</a></h5>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl wait compositiondefinition fireworksapp-cd-v2 --for condition=Ready=True --namespace fireworksapp-system --timeout=600s</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>System Behavior:</strong></p>
<ul>
<li>Command waits until the CompositionDefinition is fully processed</li>
<li>During this time, Krateo is setting up the necessary controllers</li>
<li>Success means you can now create FireworksApp instances</li>
</ul>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="create-a-new-fireworksapp-instance">Create a New FireworksApp Instance<a href="#create-a-new-fireworksapp-instance" class="hash-link" aria-label="Direct link to Create a New FireworksApp Instance" title="Direct link to Create a New FireworksApp Instance">​</a></h5>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat &lt;&lt;EOF | kubectl apply -f -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: composition.krateo.io/v1-1-14</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: FireworksApp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: fireworksapp-composition-2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  namespace: fireworksapp-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  app:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    service:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      port: 31180</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      type: NodePort</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  argocd:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    application:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      destination:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        namespace: fireworks-app</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        server: https://kubernetes.default.svc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      project: default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      source:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        path: chart/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      syncPolicy:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        automated:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          prune: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          selfHeal: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    namespace: krateo-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  git:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fromRepo:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      branch: main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      credentials:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        authMethod: generic</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        secretRef:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          key: token</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          name: github-repo-creds</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          namespace: krateo-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      name: krateo-v2-template-fireworksapp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      org: krateoplatformops</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      path: skeleton/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      scmUrl: https://github.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    insecure: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    toRepo:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      apiUrl: https://api.github.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      branch: main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      credentials:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        authMethod: generic</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        secretRef:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          key: token</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          name: github-repo-creds</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          namespace: krateo-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      initialize: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      org: your-organization</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      name: fireworksapp-test-v2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      path: /</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      private: false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      scmUrl: https://github.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    unsupportedCapabilities: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="check-helm-release-status">Check Helm Release Status<a href="#check-helm-release-status" class="hash-link" aria-label="Direct link to Check Helm Release Status" title="Direct link to Check Helm Release Status">​</a></h5>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">helm list -n fireworksapp-system</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>What to Expect:</strong></p>
<ul>
<li>You should see both <code>fireworksapp-composition-1</code> and <code>fireworksapp-composition-2</code> listed</li>
<li>Each release corresponds to its respective version</li>
<li>This confirms that both versions are deployed and managed independently</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="2-upgrading-compositions-massive-migration">2. Upgrading Compositions (massive migration)<a href="#2-upgrading-compositions-massive-migration" class="hash-link" aria-label="Direct link to 2. Upgrading Compositions (massive migration)" title="Direct link to 2. Upgrading Compositions (massive migration)">​</a></h4>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="scenario-1">Scenario:<a href="#scenario-1" class="hash-link" aria-label="Direct link to Scenario:" title="Direct link to Scenario:">​</a></h5>
<p>You need to upgrade the existing version of the application to a newer version (1.1.14). To be sure the new version can be deployed, the <code>values.schema.json</code> should not add any new required fields or remove any existing required fields. If you need to add new required fields, you should create a new <code>CompositionDefinition</code> with the new version of the chart. Refer to <a href="#3-upgrading-compositions-with-changes-in-the-valuesschemajson">the next section</a> for more details.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl patch compositiondefinition fireworksapp-cd \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -n fireworksapp-system \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --type=merge \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -p &#x27;{&quot;spec&quot;:{&quot;chart&quot;:{&quot;version&quot;:&quot;1.1.14&quot;}}}&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Upgrade Process:</strong></p>
<ul>
<li>The controller gradually reconciles existing resources</li>
<li>New pods are rolled out using the updated version</li>
<li>The system ensures zero-downtime during transition</li>
<li>All components eventually reflect the new version</li>
<li>The old version is marked for cleanup</li>
</ul>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="automatic-deletion-of-unused-composition-dynamic-controller-deployments">Automatic Deletion of Unused <code>composition-dynamic-controller</code> Deployments<a href="#automatic-deletion-of-unused-composition-dynamic-controller-deployments" class="hash-link" aria-label="Direct link to automatic-deletion-of-unused-composition-dynamic-controller-deployments" title="Direct link to automatic-deletion-of-unused-composition-dynamic-controller-deployments">​</a></h5>
<p>Notice that the previously deployed instances (pods) of <code>composition-dynamic-controller</code> that were configured to manage resources of version 1.1.14 no longer exist in the cluster.</p>
<p>This is due to the automatic cleanup mechanism that removes older and unused deployments along with their associated RBAC resources from the cluster:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get po -n fireworksapp-system</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This automatic cleanup helps maintain cluster cleaniness by removing outdated controller instances when they are no longer needed.</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="check-helm-release-status-1">Check Helm Release Status<a href="#check-helm-release-status-1" class="hash-link" aria-label="Direct link to Check Helm Release Status" title="Direct link to Check Helm Release Status">​</a></h5>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">helm list -n fireworksapp-system</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>What to Expect:</strong></p>
<ul>
<li>You should see both <code>fireworksapp-composition-1</code> and <code>fireworksapp-composition-2</code> listed</li>
<li>Each release corresponds to its respective version but now <code>fireworksapp-composition-1</code> will be updated to version 1.1.14</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="3-upgrading-compositions-with-changes-in-the-valuesschemajson">3. Upgrading Compositions with changes in the <code>values.schema.json</code><a href="#3-upgrading-compositions-with-changes-in-the-valuesschemajson" class="hash-link" aria-label="Direct link to 3-upgrading-compositions-with-changes-in-the-valuesschemajson" title="Direct link to 3-upgrading-compositions-with-changes-in-the-valuesschemajson">​</a></h4>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="scenario-2">Scenario:<a href="#scenario-2" class="hash-link" aria-label="Direct link to Scenario:" title="Direct link to Scenario:">​</a></h5>
<p>This can be useful for upgrading a chart where you have changed the <code>values.schema.json</code> (in particular adding required fields or modifying existing fields) and you want to ensure that the new version can be deployed without issues.</p>
<p>Suppose you have installed composition <code>fireworksapp-cd</code> with version 1.1.13 and you want to upgrade it to version 1.1.14, but the new version has changes in the <code>values.schema.json</code> that require you to create a new <code>CompositionDefinition</code> with the new version of the chart.</p>
<p>The first step is to create a new <code>CompositionDefinition</code> with the new version of the chart. You can do this by applying the following manifest as done in <a href="#1-deploying-multiple-versions">the previous section</a>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat &lt;&lt;EOF | kubectl apply -f -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: core.krateo.io/v1alpha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: CompositionDefinition</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: fireworksapp-cd-v2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  namespace: fireworksapp-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  chart:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    repo: fireworks-app</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    url: https://charts.krateo.io</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    version: 1.1.14</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>At this point, you have two <code>CompositionDefinition</code> resources in the cluster: <code>fireworksapp-cd</code> with version 1.1.13 and <code>fireworksapp-cd-v2</code> with version 1.1.14.</p>
<p>At this point, suppose you need to upgrade an existing release of a composition to the new version. You can do this by following the steps below:</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="step-1-pause-the-composition-with-the-old-version">Step 1: Pause the Composition with the Old Version<a href="#step-1-pause-the-composition-with-the-old-version" class="hash-link" aria-label="Direct link to Step 1: Pause the Composition with the Old Version" title="Direct link to Step 1: Pause the Composition with the Old Version">​</a></h5>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl annotate fireworksapp fireworksapp-composition-1 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -n fireworksapp-system \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;krateo.io/paused=true&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This ensures that the old version of the composition is not reconciled while you are upgrading to the new version.</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="step-2-create-a-new-fireworksapp-instance-with-the-new-version">Step 2: Create a New FireworksApp Instance with the New Version<a href="#step-2-create-a-new-fireworksapp-instance-with-the-new-version" class="hash-link" aria-label="Direct link to Step 2: Create a New FireworksApp Instance with the New Version" title="Direct link to Step 2: Create a New FireworksApp Instance with the New Version">​</a></h5>
<p>Create a new FireworksApp instance with the new version of the chart. Note that you need to add a label called <code>krateo.io/release-name</code> to the new FireworksApp instance. This label is used by the <code>composition-dynamic-controller</code> to identify the release name of the composition. The value of this label should be the same as the name of the old FireworksApp instance. In the following example, the value of the label is <code>fireworksapp-composition-1</code>, which is the name of the release installed at <a href="#3-creating-the-fireworksapp-instance">step 1</a>. Normally, this label is automatically added to the FireworksApp instance when it is created. However, in this case, you need to add it manually because you are creating a new FireworksApp instance with a different name.</p>
<p>You can do that by applying the following manifest:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat &lt;&lt;EOF | kubectl apply -f -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: composition.krateo.io/v1-1-14</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: FireworksApp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: fireworksapp-composition-2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  namespace: fireworksapp-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  labels:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    krateo.io/release-name: fireworksapp-composition-1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  app:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    service:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      port: 31180</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      type: NodePort</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  argocd:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    application:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      destination:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        namespace: fireworks-app</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        server: https://kubernetes.default.svc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      project: default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      source:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        path: chart/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      syncPolicy:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        automated:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          prune: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          selfHeal: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    namespace: krateo-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  git:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fromRepo:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      branch: main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      credentials:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        authMethod: generic</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        secretRef:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          key: token</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          name: github-repo-creds</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          namespace: krateo-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      name: krateo-v2-template-fireworksapp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      org: krateoplatformops</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      path: skeleton/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      scmUrl: https://github.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    insecure: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    toRepo:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      apiUrl: https://api.github.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      branch: main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      credentials:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        authMethod: generic</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        secretRef:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          key: token</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          name: github-repo-creds</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          namespace: krateo-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      initialize: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      org: your-organization</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      name: fireworksapp-test-v2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      path: /</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      private: false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      scmUrl: https://github.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    unsupportedCapabilities: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>At this point, the helm release <code>fireworksapp-composition-1</code>  will be upgraded to version 1.1.14.</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="step-3-remove-the-old-composition-at-version-1113">Step 3: Remove the old composition at version 1.1.13<a href="#step-3-remove-the-old-composition-at-version-1113" class="hash-link" aria-label="Direct link to Step 3: Remove the old composition at version 1.1.13" title="Direct link to Step 3: Remove the old composition at version 1.1.13">​</a></h5>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl delete fireworksapp fireworksapp-composition-1 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -n fireworksapp-system</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You also need to remove the finalizer in the old composition because the annotation <code>krateo.io/paused=true</code> will prevent the old composition from being deleted. You can do this by applying the following command:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl patch fireworksapp fireworksapp-composition-1 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -n fireworksapp-system \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --type=merge \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -p &#x27;{&quot;metadata&quot;:{&quot;finalizers&quot;:null}}&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>At this point, the old composition will be deleted and the new composition will be upgraded to version 1.1.14.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="4-pausing-composition-reconciliation">4. Pausing Composition Reconciliation<a href="#4-pausing-composition-reconciliation" class="hash-link" aria-label="Direct link to 4. Pausing Composition Reconciliation" title="Direct link to 4. Pausing Composition Reconciliation">​</a></h4>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="use-case">Use Case:<a href="#use-case" class="hash-link" aria-label="Direct link to Use Case:" title="Direct link to Use Case:">​</a></h5>
<p>Temporarily stop automatic reconciliation during maintenance or troubleshooting.</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="step-1-pause-composition">Step 1: Pause Composition<a href="#step-1-pause-composition" class="hash-link" aria-label="Direct link to Step 1: Pause Composition" title="Direct link to Step 1: Pause Composition">​</a></h5>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl annotate fireworksapp fireworksapp-composition-1 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -n fireworksapp-system \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;krateo.io/paused=true&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Expected Result:</strong></p>
<ul>
<li>Composition is annotated with <code>krateo.io/paused=true</code></li>
<li>Controller stops reconciling this instance</li>
<li>Verify with:<!-- -->
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get fireworksapp fireworksapp-composition-1 -n fireworksapp-system -o jsonpath=&#x27;{.metadata.annotations}&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<!-- -->You could also check events:<!-- -->
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get events -n fireworksapp-system --sort-by=&#x27;.metadata.creationTimestamp&#x27; | grep &quot;fireworksapp-composition-1&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ul>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="step-2-make-manual-changes">Step 2: Make Manual Changes<a href="#step-2-make-manual-changes" class="hash-link" aria-label="Direct link to Step 2: Make Manual Changes" title="Direct link to Step 2: Make Manual Changes">​</a></h5>
<p>During paused state, you can:</p>
<ul>
<li>Manually modify resources</li>
<li>Troubleshoot issues</li>
<li>Perform maintenance</li>
</ul>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="step-3-resume-reconciliation">Step 3: Resume Reconciliation<a href="#step-3-resume-reconciliation" class="hash-link" aria-label="Direct link to Step 3: Resume Reconciliation" title="Direct link to Step 3: Resume Reconciliation">​</a></h5>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl annotate fireworksapp fireworksapp-composition-1 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -n fireworksapp-system \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;krateo.io/paused-&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Expected Result:</strong></p>
<ul>
<li>Pause annotation is removed</li>
<li>Controller resumes normal operation</li>
<li>Changes are reconciled according to desired state</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="5-pausing-composition-gracefully">5. Pausing Composition Gracefully<a href="#5-pausing-composition-gracefully" class="hash-link" aria-label="Direct link to 5. Pausing Composition Gracefully" title="Direct link to 5. Pausing Composition Gracefully">​</a></h4>
<p><code>composition-dynamic-controller</code> 0.19.3 and later (released with <code>core-provider-chart</code> 0.33.4) supports a graceful pause mechanism that ensures any resource managed by the composition will be paused <em>before</em> the composition reconciliation is paused. This means the resources managed by the composition will not be reconciled until the composition is resumed.</p>
<p>To support this feature, you need to follow the steps described in the <a href="https://github.com/krateoplatformops/composition-dynamic-controller?tab=readme-ov-file#about-the-gracefullypaused-value" target="_blank" rel="noopener noreferrer"><code>composition-dynamic-controller</code> documentation</a>. Please note that this feature is not supported for compositions created with versions of <code>composition-dynamic-controller</code> earlier than 0.19.3, and you will need to modify your chart according to the documentation linked above.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="6-safely-deleting-compositions">6. Safely Deleting Compositions<a href="#6-safely-deleting-compositions" class="hash-link" aria-label="Direct link to 6. Safely Deleting Compositions" title="Direct link to 6. Safely Deleting Compositions">​</a></h4>
<p>You can safely delete all compositions and their associated resources using the following command:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl delete compositiondefinition fireworksapp-cd \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -n fireworksapp-system</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Expected Outcome:</strong></p>
<ul>
<li>The <code>deletionTimestamp</code> is set in the generated CRD and in all the compositions related to this CRD.</li>
<li>The <code>compositiondefinition</code> and all associated resources are deleted. (It may take a few minutes because any release associated with the composition will be deleted first.)</li>
</ul>
<p>Note: If some compositions are stuck in the deletion process, do not enforce their deletion by removing the finalizer in the CRD. Instead, you should check the logs of the <code>composition-dynamic-controller</code> to understand why the deletion is stuck. If you need to force the deletion, you can do so by removing the finalizer in the composition CR. Then the core-provider will safely delete the CRD.</p>
<p>Deleting the finalizer in the CRD can cause problems with Kubernetes etcd, so it is not recommended. See section 5. Error after creating CompositionDefinition for troubleshooting.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="troubleshooting-guide">Troubleshooting Guide<a href="#troubleshooting-guide" class="hash-link" aria-label="Direct link to Troubleshooting Guide" title="Direct link to Troubleshooting Guide">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="common-issues-and-diagnostic-procedures">Common Issues and Diagnostic Procedures<a href="#common-issues-and-diagnostic-procedures" class="hash-link" aria-label="Direct link to Common Issues and Diagnostic Procedures" title="Direct link to Common Issues and Diagnostic Procedures">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="1-compositiondefinition-not-becoming-ready">1. CompositionDefinition Not Becoming Ready<a href="#1-compositiondefinition-not-becoming-ready" class="hash-link" aria-label="Direct link to 1. CompositionDefinition Not Becoming Ready" title="Direct link to 1. CompositionDefinition Not Becoming Ready">​</a></h4>
<p><strong>Symptoms:</strong></p>
<ul>
<li>CompositionDefinition remains in &quot;Not Ready&quot; state</li>
<li>No corresponding controller pod created</li>
<li>CRD not generated</li>
</ul>
<p><strong>Diagnostic Steps:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Check CompositionDefinition status details</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl describe compositiondefinition &lt;name&gt; -n fireworksapp-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Examine core provider logs for processing errors</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl logs -n krateo-system -l app=core-provider --tail=100</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>What to Look For:</strong></p>
<ul>
<li>In the describe output: Check &quot;Status.Conditions&quot; for error messages</li>
<li>In core provider logs: Look for chart download or CRD generation failures</li>
<li>Verify network connectivity to the chart repository</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="2-compositions-failing-to-deploy">2. Compositions Failing to Deploy<a href="#2-compositions-failing-to-deploy" class="hash-link" aria-label="Direct link to 2. Compositions Failing to Deploy" title="Direct link to 2. Compositions Failing to Deploy">​</a></h4>
<p><strong>Symptoms:</strong></p>
<ul>
<li>FireworksApp resource stuck in &quot;Not Ready&quot; state</li>
</ul>
<p><strong>Diagnostic Steps:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Get detailed status of the composition</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl describe fireworksapp &lt;name&gt; -n fireworksapp-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Check controller logs for reconciliation errors</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl logs -n fireworksapp-system -l app.kubernetes.io/name=fireworksapps-controller</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Verify ArgoCD application status</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get application -n krateo-system</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>What to Examine:</strong></p>
<ul>
<li>Events section in describe output for resource creation failures</li>
<li>Controller logs for Git operations or resource deployment errors</li>
<li>ArgoCD application health and sync status</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="3-upgraderollback-failures">3. Upgrade/Rollback Failures<a href="#3-upgraderollback-failures" class="hash-link" aria-label="Direct link to 3. Upgrade/Rollback Failures" title="Direct link to 3. Upgrade/Rollback Failures">​</a></h4>
<p><strong>Symptoms:</strong></p>
<ul>
<li>Version transition stuck</li>
<li>Mixed version resources</li>
<li>Controller crash loops</li>
</ul>
<p><strong>Diagnostic Steps:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Check rollout status of controller deployment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl rollout status deployment/fireworksapps-v1-1-14-controller -n fireworksapp-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Verify resource versions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get all -n fireworks-app -l krateo.io/composition-version</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Compare desired vs actual state</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get fireworksapp -n fireworksapp-system -o yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Investigation Areas:</strong></p>
<ul>
<li>Resource version labels consistency</li>
<li>Controller pod logs for reconciliation errors</li>
<li>Helm release history for the composition</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="4-certificate-issues-mutating-webhook-configuration---valid-only-for-versions-of-core-provider-before-0242">4. Certificate Issues: Mutating Webhook Configuration - Valid ONLY for versions of core-provider before <code>&lt;0.24.2</code><a href="#4-certificate-issues-mutating-webhook-configuration---valid-only-for-versions-of-core-provider-before-0242" class="hash-link" aria-label="Direct link to 4-certificate-issues-mutating-webhook-configuration---valid-only-for-versions-of-core-provider-before-0242" title="Direct link to 4-certificate-issues-mutating-webhook-configuration---valid-only-for-versions-of-core-provider-before-0242">​</a></h4>
<p><strong>Note:</strong> This issue is only valid for versions of core-provider before <code>&lt;0.24.2</code>. In versions after this, the management of certificates is automatically handled by the core-provider and you should not face this issue.</p>
<p><strong>Symptoms:</strong></p>
<ul>
<li>You receive an error like <code>Internal error occurred: failed calling webhook &quot;core.provider.krateo.io&quot;: failed to call webhook: Post &quot;https://core-provider-webhook- service.krateo-v2-system.svc:9443/mutate? timeout=10s&quot;: t|s: failed to verify certificate: x509: certificate signed by unknown authority (possibly because of &quot;crypto/rsa: verification error&quot; while trying to verify candidate authority certificate &quot;core-provider-webhook- service.krateo-v2-system.svc&quot;)</code></li>
<li>You cannot create the related composition in the cluster</li>
</ul>
<p><strong>Diagnostic Steps:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Check the caBundle in the core-provider-webhook-service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get mutatingWebhookConfiguration core-provider -o jsonpath=&#x27;{.webhooks[0].clientConfig.caBundle}&#x27; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Check if the base64 encoded caBundle is aligned with the core-provider tls secret</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get secret core-provider-certs -n krateo-system -o json | jq -r &#x27;.data[&quot;tls.crt&quot;]&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If you receive the error described above, the caBundle is not aligned with the core-provider tls secret. So you need to patch the caBundle in the core-provider mutatingWebhookConfiguration.</p>
<p><strong>Remediation Steps:</strong></p>
<ul>
<li>Patch the caBundle in the core-provider mutatingWebhookConfiguration using the command provided above.</li>
</ul>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">caBundle=$(kubectl get secret core-provider-certs -n krateo-system -o json | jq -r &#x27;.data[&quot;tls.crt&quot;]&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl patch mutatingWebhookConfiguration core-provider \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --type=&#x27;json&#x27; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -p=&#x27;[{&quot;op&quot;: &quot;replace&quot;, &quot;path&quot;: &quot;/webhooks/0/clientConfig/caBundle&quot;, &quot;value&quot;: &quot;&#x27;&quot;$caBundle&quot;&#x27;&quot;}]&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="41-certificate-issues-conversion-webhook-configuration">4.1 Certificate Issues: Conversion Webhook Configuration<a href="#41-certificate-issues-conversion-webhook-configuration" class="hash-link" aria-label="Direct link to 4.1 Certificate Issues: Conversion Webhook Configuration" title="Direct link to 4.1 Certificate Issues: Conversion Webhook Configuration">​</a></h4>
<p><strong>Symptoms:</strong></p>
<ul>
<li>You receive an error like <code>conversion webhook for composition.krateo.io/v0-0-13, Kind=KrateoTemplateToolAwsGlueJobs failed: Post \&quot;https://core-provider-webhook-service.krateo-v2-system.svc:9443/convert?timeout=30s\&quot;: tls: failed to verify certificate: x509: certificate signed by unknown authority</code></li>
<li>You cannot create the related composition in the cluster</li>
</ul>
<p><strong>Diagnostic Steps:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Check the caBundle in the core-provider-webhook-service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get crds &lt;your-crd-name&gt; -o jsonpath=&#x27;{.spec.conversion.webhook.clientConfig.caBundle}&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Check if the base64 encoded caBundle is aligned with the core-provider tls secret</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get secret core-provider-certs -n krateo-system -o json | jq -r &#x27;.data[&quot;tls.crt&quot;]&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Remediation Steps:</strong></p>
<ul>
<li>Patch the caBundle in the core-provider mutatingWebhookConfiguration using the command provided above.</li>
</ul>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">caBundle=$(kubectl get secret core-provider-certs -n krateo-system -o json | jq -r &#x27;.data[&quot;tls.crt&quot;]&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl patch crd &lt;your-crd-name&gt; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --type=&#x27;json&#x27; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -p=&#x27;[{&quot;op&quot;: &quot;replace&quot;, &quot;path&quot;: &quot;/spec/conversion/webhook/clientConfig/caBundle&quot;, &quot;value&quot;: &quot;&#x27;&quot;$caBundle&quot;&#x27;&quot;}]&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You will need to replace <code>&lt;your-crd-name&gt;</code> with the name of the CRD you are trying to create.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="5-error-after-creating-compositiondefinition">5. Error after creating CompositionDefinition<a href="#5-error-after-creating-compositiondefinition" class="hash-link" aria-label="Direct link to 5. Error after creating CompositionDefinition" title="Direct link to 5. Error after creating CompositionDefinition">​</a></h4>
<p><strong>Symptoms:</strong></p>
<ul>
<li>You receive an error like <code>request to convert CR from an invalid group/version: composition.krateo.io/vacuum</code></li>
<li>You cannot create the related composition in the cluster</li>
</ul>
<p><strong>Diagnostic Steps:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># This error is usually present in the Kubernetes API server logs, in core-provider logs, and is also generally present when listing `compositions`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get compositions -A</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Remediation Steps:</strong></p>
<ul>
<li>To solve this issue, you need to force core-provider to re-create the <code>vacuum</code> version in the CRD. You can do this changing the version of the chart in the <code>CompositionDefinition</code>.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="general-diagnostic-tools">General Diagnostic Tools<a href="#general-diagnostic-tools" class="hash-link" aria-label="Direct link to General Diagnostic Tools" title="Direct link to General Diagnostic Tools">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Cluster-wide event inspection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get events -A --sort-by=&#x27;.metadata.creationTimestamp&#x27; | grep -i &quot;error\|fail&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Cross-namespace pod status check</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get pods -A -o wide | grep -E &quot;krateo-system|fireworksapp-system&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># API resource verification</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl api-resources | grep fireworksapp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Network connectivity tests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl run -it --rm --restart=Never network-test \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --image=alpine -n fireworksapp-system -- \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ping charts.krateo.io</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="common-solutions">Common Solutions<a href="#common-solutions" class="hash-link" aria-label="Direct link to Common Solutions" title="Direct link to Common Solutions">​</a></h3>
<ol>
<li>
<p><strong>Authentication Issues:</strong></p>
<ul>
<li>Regenerate Service token with correct scopes</li>
<li>Recreate the secret with proper formatting</li>
<li>Verify network policies allow outbound connections</li>
</ul>
</li>
<li>
<p><strong>Version Conflicts:</strong></p>
<ul>
<li>Manually clean up orphaned resources</li>
<li>Delete and recreate the CompositionDefinition</li>
<li>Verify chart compatibility between versions</li>
</ul>
</li>
<li>
<p><strong>Resource Constraints:</strong></p>
<ul>
<li>Check pod resource limits and node availability</li>
<li>Review pending pods with <code>kubectl get pods --field-selector=status.phase=Pending</code></li>
<li>Increase cluster resources if needed</li>
</ul>
</li>
</ol></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/key-concepts/kco/core-provider"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">core-provider</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/key-concepts/kco/composition-dynamic-controller"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">composition-dynamic-controller</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#comprehensive-deployment-guide-with-expected-outcomes" class="table-of-contents__link toc-highlight">Comprehensive Deployment Guide with Expected Outcomes</a></li><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a></li><li><a href="#prerequisites" class="table-of-contents__link toc-highlight">Prerequisites</a><ul><li><a href="#initial-setup" class="table-of-contents__link toc-highlight">Initial Setup</a></li><li><a href="#core-platform-installation" class="table-of-contents__link toc-highlight">Core Platform Installation</a></li><li><a href="#compositiondefinition-deployment" class="table-of-contents__link toc-highlight">CompositionDefinition Deployment</a></li><li><a href="#creating-compositions" class="table-of-contents__link toc-highlight">Creating Compositions</a></li><li><a href="#advanced-operations" class="table-of-contents__link toc-highlight">Advanced Operations</a></li></ul></li><li><a href="#troubleshooting-guide" class="table-of-contents__link toc-highlight">Troubleshooting Guide</a><ul><li><a href="#common-issues-and-diagnostic-procedures" class="table-of-contents__link toc-highlight">Common Issues and Diagnostic Procedures</a></li><li><a href="#general-diagnostic-tools" class="table-of-contents__link toc-highlight">General Diagnostic Tools</a></li><li><a href="#common-solutions" class="table-of-contents__link toc-highlight">Common Solutions</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Krateo</div></div></div></footer></div>
</body>
</html>