<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-key-concepts/kog/oasgen-provider-cheatsheet" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">Krateo Operator Generator (KOG) Cheatsheet | Krateo PlatformOps Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://docs.krateo.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://docs.krateo.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://docs.krateo.io/key-concepts/kog/oasgen-provider-cheatsheet"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Krateo Operator Generator (KOG) Cheatsheet | Krateo PlatformOps Docs"><meta data-rh="true" name="description" content="(KOG = oasgen-provider + rest-dynamic-controller)"><meta data-rh="true" property="og:description" content="(KOG = oasgen-provider + rest-dynamic-controller)"><link data-rh="true" rel="icon" href="/img/favicon_io/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.krateo.io/key-concepts/kog/oasgen-provider-cheatsheet"><link data-rh="true" rel="alternate" href="https://docs.krateo.io/key-concepts/kog/oasgen-provider-cheatsheet" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.krateo.io/key-concepts/kog/oasgen-provider-cheatsheet" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.6738e5fb.css">
<script src="/assets/js/runtime~main.e1eb34dc.js" defer="defer"></script>
<script src="/assets/js/main.56204778.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" target="_self" href="/"><div class="navbar__logo"><img src="/img/black-horizontal.svg" alt="Krateo PlatformOps Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/white-horizontal.svg" alt="Krateo PlatformOps Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Docs</b></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/krateoplatformops/krateo" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://killercoda.com/krateoplatformops/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Krateo Free Self-Service Labs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/key-concepts/kco/core-provider">Key Concepts</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/key-concepts/kco/core-provider">Krateo Composable Operations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/key-concepts/kcp/frontend">Krateo Composable Portal</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/key-concepts/kcf/finops-introduction">Krateo Composable FinOps</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/key-concepts/kog/oasgen-provider">Krateo Operator Generator</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/key-concepts/kog/oasgen-provider">Krateo OASGen Provider</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/key-concepts/kog/oasgen-provider-cheatsheet">Krateo Operator Generator (KOG) Cheatsheet</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/key-concepts/kog/rest-dynamic-controller">rest-dynamic-controller</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/quickstart">Quickstart</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/how-to-guides/install-krateo/installing-krateo-kind">How-to guides</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/core-crd-reference/core-provider-crd">Krateo CRD Reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/provider-crd-reference/azuredevops-provider-crd">Provider CRD Reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/provider-reference/github-provider-kog">Provider Reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/release-notes/release-note-2-5-0">Release Notes</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Key Concepts</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Krateo Operator Generator</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Krateo Operator Generator (KOG) Cheatsheet</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Krateo Operator Generator (KOG) Cheatsheet</h1>
<p><em>(KOG = <code>oasgen-provider</code> + <code>rest-dynamic-controller</code>)</em></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="table-of-contents">Table of Contents<a href="#table-of-contents" class="hash-link" aria-label="Direct link to Table of Contents" title="Direct link to Table of Contents">​</a></h2>
<ul>
<li><a href="#prerequisites">Prerequisites</a></li>
<li><a href="#what-to-do-when-the-openapi-specification-oas-is-missingincomplete-or-not-at-version-30">What to do when the OpenAPI Specification (OAS) is missing/incomplete or not at version 3.0+?</a></li>
<li><a href="#simple-case-external-apis-compatible-with-k8s-resource-management">Simple Case: External APIs Compatible with K8s Resource Management</a></li>
<li><a href="#extended-example-external-api-that-requires-a-plugin-to-handle-external-api-calls">Extended Example: External API that requires a plugin to handle external API calls</a></li>
<li><a href="#best-practices">Best Practices</a></li>
<li><a href="#troubleshooting">Troubleshooting</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="prerequisites">Prerequisites<a href="#prerequisites" class="hash-link" aria-label="Direct link to Prerequisites" title="Direct link to Prerequisites">​</a></h2>
<ul>
<li>Kubernetes cluster with Krateo installed</li>
<li><code>kubectl</code> configured to access your cluster</li>
<li>OpenAPI Specification (OAS) 3.0+ for your target API</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-to-do-when-the-openapi-specification-oas-is-missingincomplete-or-not-at-version-30">What to do when the OpenAPI Specification (OAS) is missing/incomplete or not at version 3.0+?<a href="#what-to-do-when-the-openapi-specification-oas-is-missingincomplete-or-not-at-version-30" class="hash-link" aria-label="Direct link to What to do when the OpenAPI Specification (OAS) is missing/incomplete or not at version 3.0+?" title="Direct link to What to do when the OpenAPI Specification (OAS) is missing/incomplete or not at version 3.0+?">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="first-scenario-the-service-does-not-provide-an-openapi-specification-oas-but-it-exposes-a-rest-api">First Scenario: the service does not provide an OpenAPI Specification (OAS) but it exposes a REST API<a href="#first-scenario-the-service-does-not-provide-an-openapi-specification-oas-but-it-exposes-a-rest-api" class="hash-link" aria-label="Direct link to First Scenario: the service does not provide an OpenAPI Specification (OAS) but it exposes a REST API" title="Direct link to First Scenario: the service does not provide an OpenAPI Specification (OAS) but it exposes a REST API">​</a></h3>
<p>In this case, the way to go is to locate the endpoints you want to use in your generated controller from the API documentation of your service and manually create the OpenAPI Specification (OAS) 3.0+ for those endpoints. You can use tools like <a href="https://editor.swagger.io/" target="_blank" rel="noopener noreferrer">Swagger Editor</a> to create and validate your OAS. This process seems tedious, but it is necessary for <code>oasgen-provider</code> to have a well-defined OAS to generate the CRDs and controllers correctly, and it is also useful for you to have a clear understanding of the API objects you want to manage.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="second-scenario-the-service-does-not-expose-a-rest-api-but-you-have-another-way-to-interact-with-it-eg-grpc-graphql-etc">Second Scenario: the service does not expose a REST API but you have another way to interact with it (e.g., gRPC, GraphQL, etc.)<a href="#second-scenario-the-service-does-not-expose-a-rest-api-but-you-have-another-way-to-interact-with-it-eg-grpc-graphql-etc" class="hash-link" aria-label="Direct link to Second Scenario: the service does not expose a REST API but you have another way to interact with it (e.g., gRPC, GraphQL, etc.)" title="Direct link to Second Scenario: the service does not expose a REST API but you have another way to interact with it (e.g., gRPC, GraphQL, etc.)">​</a></h3>
<p>In this case, you can create a web service that acts as a bridge between the Krateo oasgen-provider and the service you want to manage. The web service should implement the necessary logic to interact with the service and expose a REST API that is compatible with Kubernetes resource management. You can then use the OAS for the web service to generate the CRDs and controllers using oasgen-provider.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="about-openapi-specification-oas-30">About OpenAPI Specification (OAS) 3.0+<a href="#about-openapi-specification-oas-30" class="hash-link" aria-label="Direct link to About OpenAPI Specification (OAS) 3.0+" title="Direct link to About OpenAPI Specification (OAS) 3.0+">​</a></h3>
<p>The OAS should include the following information:</p>
<ul>
<li>
<p><strong>Servers</strong>: The <code>servers</code> field (at root level of the OAS) should define the base URL for the API endpoints you want to use. This is important for the provider to know where to send requests. Note that you can override the base URL in the OAS if you want to use a different URL for the API endpoints; refer <a href="#step-7-update-the-restdefinition-to-use-the-web-service">the a following section</a> for more information.</p>
</li>
<li>
<p><strong>API endpoints (paths)</strong>: It should contain the paths for the API endpoints you want to use, including the HTTP methods (GET, POST, PUT, DELETE) and any parameters required by the endpoints. Note that it is important to specify whether the parameters are required or optional, as this will affect the generated CRDs and controllers. To learn more about how these paths are used by <code>rest-dynamic-controller</code>, refer to the <a href="/key-concepts/kog/oasgen-provider#restdefinition">RestDefinition section</a> of the README. Note that any endpoint should have consistent behavior and whenever this is not the case, there may be the need to implmenent a plugin web server to normalize and fix the behavior of the API endpoints.</p>
</li>
<li>
<p><strong>Request and response schemas</strong>: It should define the request and response schemas for each endpoint, including the data types and any validation rules.</p>
</li>
<li>
<p><strong>Authentication</strong>: If the API requires authentication, you should define the security schemes in the <code>components</code> section of the OAS. This is important for the provider to know how to authenticate requests to the API. You can see supported authentication methods <a href="/key-concepts/kog/oasgen-provider#authentication">here</a>.</p>
</li>
</ul>
<p>Also note that any modification to the request or response schemas made by the API provider will require you to update the OAS accordingly, as the provider will generate the CRDs and controllers based on the OAS. Also consider removing the RestDefinition and recreating it with the updated OAS to ensure that the provider generates the correct CRDs and controllers (this is not necessary if you do not make changes to the request body or path parameters, as <code>oasgen-provider</code> won&#x27;t need to update the generated CRD).</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="supported-authentication-methods">Supported authentication methods<a href="#supported-authentication-methods" class="hash-link" aria-label="Direct link to Supported authentication methods" title="Direct link to Supported authentication methods">​</a></h3>
<p>Use <code>securitySchemes</code> in the OAS to define the authentication method used by the API.
The following authentication methods are supported:</p>
<ul>
<li><strong>Bearer Token</strong></li>
</ul>
<div class="language-diff codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-diff codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openapi: 3.0.3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">servers:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - url: https://api.github.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">paths:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">components:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+ securitySchemes:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+   bearer:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+     type: http</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+     scheme: bearer</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li><strong>Basic Authentication</strong></li>
</ul>
<div class="language-diff codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-diff codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openapi: 3.0.3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">servers:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - url: https://api.github.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">paths:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">components:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+ securitySchemes:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+   basic:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+     type: http</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+     scheme: basic</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="simple-case-external-apis-compatible-with-k8s-resource-management">Simple Case: External APIs Compatible with K8s Resource Management<a href="#simple-case-external-apis-compatible-with-k8s-resource-management" class="hash-link" aria-label="Direct link to Simple Case: External APIs Compatible with K8s Resource Management" title="Direct link to Simple Case: External APIs Compatible with K8s Resource Management">​</a></h2>
<p>This guide provides a step-by-step approach to generating a provider for managing GitHub repositories using the Krateo Operator Generator (KOG). It assumes you have a basic understanding of Kubernetes and OpenAPI specifications.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-1-prepare-your-openapi-specification">Step 1: Prepare Your OpenAPI Specification<a href="#step-1-prepare-your-openapi-specification" class="hash-link" aria-label="Direct link to Step 1: Prepare Your OpenAPI Specification" title="Direct link to Step 1: Prepare Your OpenAPI Specification">​</a></h3>
<ol>
<li>
<p><strong>Obtain or generate</strong> the OAS for your target API</p>
<ul>
<li>Example: GitHub API OAS available at <a href="https://github.com/github/rest-api-description/blob/main/descriptions/ghes-3.9/ghes-3.9.yaml" target="_blank" rel="noopener noreferrer">GitHub&#x27;s REST API description</a></li>
</ul>
</li>
<li>
<p><strong>Scope your OAS</strong> to only include necessary endpoints:</p>
<ul>
<li>Recommended for large APIs to reduce complexity</li>
<li>Create separate files for different resource types (e.g., <code>repositories.yaml</code>, <code>teamrepo.yaml</code>)</li>
</ul>
</li>
<li>
<p><strong>Add authentication</strong> information if missing from original OAS.
In particular, the section <code>securitySchemes</code> should be added under <code>components</code> root element:</p>
</li>
</ol>
<div class="language-diff codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-diff codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openapi: 3.0.3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">servers:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - url: https://api.github.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">paths:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">components:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+ securitySchemes:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+   bearer:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+     type: http</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+     scheme: bearer</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-2-prepare-kubernetes-environment">Step 2: Prepare Kubernetes Environment<a href="#step-2-prepare-kubernetes-environment" class="hash-link" aria-label="Direct link to Step 2: Prepare Kubernetes Environment" title="Direct link to Step 2: Prepare Kubernetes Environment">​</a></h3>
<ol>
<li>
<p>Create a dedicated namespace:</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl create namespace gh-system</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Store your OAS as a ConfigMap:
In this example, we use a sample OAS for GitHub repositories stored in <a href="https://github.com/krateoplatformops/oasgen-provider/blob/main/samples/usage_guide/assets/repo.yaml" target="_blank" rel="noopener noreferrer"><code>samples/usage_guide/assets/repo.yaml</code></a> of this repository.</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl create configmap repo --from-file=samples/usage_guide/assets/repo.yaml -n gh-system</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-3-create-restdefinition-for-github-repositories">Step 3: Create RestDefinition for GitHub Repositories<a href="#step-3-create-restdefinition-for-github-repositories" class="hash-link" aria-label="Direct link to Step 3: Create RestDefinition for GitHub Repositories" title="Direct link to Step 3: Create RestDefinition for GitHub Repositories">​</a></h3>
<p>In order to create a RestDefinition for GitHub repositories, you need to define the <code>resourceGroup</code>, <code>kind</code>, and the verbs that the controller will support.
The <code>oasPath</code> should point to the ConfigMap containing your OAS.
You can learn more about the <code>RestDefinition</code> resource <a href="/key-concepts/kog/oasgen-provider#restdefinition">here</a>.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat &lt;&lt;EOF | kubectl apply -f -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: ogen.krateo.io/v1alpha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: RestDefinition</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: gh-repo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  namespace: gh-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  oasPath: configmap://gh-system/repo/repo.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  resourceGroup: github.ogen.krateo.io</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  resource: </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    kind: Repo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    additionalStatusFields:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - html_url</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    verbsDescription:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - action: create</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      method: POST</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      path: /orgs/{org}/repos</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - action: delete</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      method: DELETE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      path: /repos/{org}/{name}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - action: get</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      method: GET</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      path: /repos/{org}/{name}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - action: update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      method: PATCH</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      path: /repos/{org}/{name}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="wait-for-the-crd-and-controller-to-be-created">Wait for the CRD and Controller to be Created<a href="#wait-for-the-crd-and-controller-to-be-created" class="hash-link" aria-label="Direct link to Wait for the CRD and Controller to be Created" title="Direct link to Wait for the CRD and Controller to be Created">​</a></h4>
<p>You can check the status of the creation by running:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl wait restdefinition gh-repo --for condition=Ready=True --namespace gh-system --timeout=600s</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="handling-schema-validation-issues">Handling Schema Validation Issues<a href="#handling-schema-validation-issues" class="hash-link" aria-label="Direct link to Handling Schema Validation Issues" title="Direct link to Handling Schema Validation Issues">​</a></h4>
<p>Common error you might encounter:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Cannot create external resource [...] error: &quot;generating CRD: missing type in schema &#x27;Title&#x27;&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="possible-solution-simplify-complex-types-recommended">Possible solution: Simplify Complex Types (Recommended)<a href="#possible-solution-simplify-complex-types-recommended" class="hash-link" aria-label="Direct link to Possible solution: Simplify Complex Types (Recommended)" title="Direct link to Possible solution: Simplify Complex Types (Recommended)">​</a></h5>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">title</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> string</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">description</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> The title of the issue.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Note:</strong> Requires a Plugin web service (API wrapper) for type conversion if original API expects different types.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-4-verification-steps">Step 4: Verification Steps<a href="#step-4-verification-steps" class="hash-link" aria-label="Direct link to Step 4: Verification Steps" title="Direct link to Step 4: Verification Steps">​</a></h3>
<ol>
<li>
<p>Check CRD creation:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get crds | grep github.ogen.krateo.io</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You should see:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> repoconfigurations.github.ogen.krateo.io    2025-06-13T08:28:06Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> repoes.github.ogen.krateo.io                2025-06-13T08:28:06Z</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<p>If you see <code>repoconfigurations</code> and <code>repoes</code>, the CRDs have been created successfully. The second CRD represents the <code>repo</code> object. The first one is the <code>repoconfiguration</code> object, which is used to authenticate requests to the GitHub API.</p>
<ol start="2">
<li>Verify controller pod:<!-- -->
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get deploy -n gh-system</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<p>You should see a deployment named <code>gh-repo-controller</code>, which is responsible for managing the <code>Repo</code> resources.</p>
<p>If you see the deployment, you can check the logs of the controller pod to see if it is running correctly:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl logs deploy/gh-repo-controller -n gh-system</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="3">
<li>Check RestDefinition status:<!-- -->
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get restdefinition -n gh-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl describe restdefinition gh-repo -n gh-system</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<p>At this point you have a running operator able to handle GitHub repositories. You can create, update, and delete repositories using the custom resource.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-5-create-the-custom-resources">Step 5: Create the Custom Resources<a href="#step-5-create-the-custom-resources" class="hash-link" aria-label="Direct link to Step 5: Create the Custom Resources" title="Direct link to Step 5: Create the Custom Resources">​</a></h3>
<p>Before creating the <code>Repo</code> custom resource, you need to create a <code>RepoConfiguration</code> custom resource and a Kubernetes secret to store your GitHub token.</p>
<p>These are used to authenticate requests to the GitHub API. The <code>bearer</code> section of the spec of <code>RepoConfiguration</code> contains a reference to the token that is used to authenticate the requests. The token is stored in a Kubernetes secret.</p>
<p>So first, create a Kubernetes secret with your GitHub token:
(generate a personal access token with the necessary permissions from your GitHub account settings)</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl create secret generic gh-token --from-literal=token=&lt;token&gt; -n gh-system </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat &lt;&lt;EOF | kubectl apply -f -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: github.ogen.krateo.io/v1alpha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: RepoConfiguration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: my-repo-config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  namespace: default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  authentication:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    bearer:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      # Reference to a secret containing the bearer token</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      tokenRef:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        name: gh-token        # Name of the secret</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        namespace: default    # Namespace where the secret exists</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        key: token            # Key within the secret that contains the token</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Create a custom resource for the <code>Repo</code> object. This is used to create, update, and delete repositories in the GitHub API. The <code>Repo</code> object contains the reference to the <code>RepoConfiguration</code> object that is used to authenticate requests:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat &lt;&lt;EOF | kubectl apply -f -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: github.ogen.krateo.io/v1alpha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: Repo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: gh-repo-1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  namespace: gh-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  configurationRef:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    name: my-repo-config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    namespace: default </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  org: krateoplatformops-test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: krateo-test-repo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  description: A short description of the repository set by Krateo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  visibility: public</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  has_issues: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You will expect that the controller creates a repository in your GitHub account with the name <code>krateo-test-repo</code> under the organization <code>krateoplatformops-test</code>. You can check the status of the repository by running:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl describe repo.github.ogen.krateo.io/gh-repo-1 -n gh-system</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You should see a successful creation event, which indicates that the repository was created successfully.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Events:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Type     Reason                         Age                  From  Message</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ----     ------                         ----                 ----  -------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Normal   CreatedExternalResource        6m30s                      Successfully requested creation of external resource</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Any edits to the <code>Repo</code> custom resource will trigger the controller to update the corresponding repository in GitHub.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-6-patch-the-custom-resource">Step 6: Patch the Custom Resource<a href="#step-6-patch-the-custom-resource" class="hash-link" aria-label="Direct link to Step 6: Patch the Custom Resource" title="Direct link to Step 6: Patch the Custom Resource">​</a></h3>
<p>To update the repository, you can patch the <code>Repo</code> custom resource. For example, to change the description of the repository:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat &lt;&lt;EOF | kubectl apply -f -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: github.ogen.krateo.io/v1alpha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: Repo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: gh-repo-1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  namespace: gh-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  configurationRef:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    name: my-repo-config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    namespace: default </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  org: krateoplatformops-test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: krateo-test-repo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  description: A new description of the repository set by Krateo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  visibility: public</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  has_issues: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This will trigger the controller to update the repository in GitHub with the new description.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl describe repo.github.ogen.krateo.io/gh-repo-1 -n gh-system</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You should see an event for the Repo resource indicating that the external resource was updated successfully:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Events:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Type     Reason                         Age                  From  Message</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ----     ------                         ----                 ----  -------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Normal   UpdatedExternalResource        10s                       Successfully requested update of external resource</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-7-delete-the-custom-resource">Step 7: Delete the Custom Resource<a href="#step-7-delete-the-custom-resource" class="hash-link" aria-label="Direct link to Step 7: Delete the Custom Resource" title="Direct link to Step 7: Delete the Custom Resource">​</a></h3>
<p>To delete the repository, you can delete the <code>Repo</code> custom resource:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl delete repo.github.ogen.krateo.io gh-repo-1 -n gh-system</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This will trigger the controller to delete the corresponding repository in GitHub.
You should see an event for the Repo resource indicating that the external resource was deleted successfully:</p>
<p>You can check the status of the deletion by running:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get events --sort-by=&#x27;.lastTimestamp&#x27; -n gh-system | grep repo/gh-repo-1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Events:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Type     Reason                         Age                  From  Message</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ----     ------                         ----                 ----  -------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Normal   DeletedExternalResource      repo/gh-repo-1        Successfully requested deletion of external resource</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="extended-example-external-api-that-requires-a-plugin-to-handle-external-api-calls">Extended Example: External API that requires a plugin to handle external API calls<a href="#extended-example-external-api-that-requires-a-plugin-to-handle-external-api-calls" class="hash-link" aria-label="Direct link to Extended Example: External API that requires a plugin to handle external API calls" title="Direct link to Extended Example: External API that requires a plugin to handle external API calls">​</a></h2>
<p>This example demonstrates how to create a Krateo provider for managing GitHub TeamRepo (Team permissions on repositories) using an external web service to handle API calls. This approach is useful when the API isn&#x27;t directly compatible with Kubernetes resource management or requires additional processing.</p>
<p>For an API to be compatible with Kubernetes resource management, it should create, update, and delete resources in a way that is similar to Kubernetes resources. This means the API should support the same operations as Kubernetes resources, such as create, update, delete, and get. If the API doesn&#x27;t support these operations or requires additional processing, you can use an external web service to handle the API calls.</p>
<p>This example assumes you have a basic understanding of Kubernetes, OpenAPI specifications, and web service development.</p>
<p><strong>Note:</strong> In this example, we&#x27;ll develop a web service that handles API calls to the GitHub API. The web service will be responsible for creating, updating, and deleting TeamRepo (Team permissions on repositories) in GitHub. While this example uses Go, you can use any programming language and framework you&#x27;re comfortable with.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-1-prepare-your-openapi-specification-1">Step 1: Prepare Your OpenAPI Specification<a href="#step-1-prepare-your-openapi-specification-1" class="hash-link" aria-label="Direct link to Step 1: Prepare Your OpenAPI Specification" title="Direct link to Step 1: Prepare Your OpenAPI Specification">​</a></h3>
<ol>
<li>
<p><strong>Obtain or generate</strong> the OAS for your target API</p>
<ul>
<li>Example: GitHub API OAS available at <a href="https://github.com/github/rest-api-description/blob/main/descriptions/ghes-3.9/ghes-3.9.yaml" target="_blank" rel="noopener noreferrer">GitHub&#x27;s REST API description</a></li>
</ul>
</li>
<li>
<p><strong>Scope your OAS</strong> to only include necessary endpoints:</p>
<ul>
<li>Recommended for large APIs to reduce complexity</li>
<li>Create separate files for different resource types (e.g., <code>repositories.yaml</code>, <code>teamrepo.yaml</code>)</li>
</ul>
</li>
<li>
<p><strong>Add authentication</strong> information if missing from the original OAS:</p>
</li>
</ol>
<div class="language-diff codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-diff codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openapi: 3.0.3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">servers:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - url: https://api.github.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">paths:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">components:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+ securitySchemes:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+   bearer:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+     type: http</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+     scheme: bearer</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-2-prepare-kubernetes-environment-1">Step 2: Prepare Kubernetes Environment<a href="#step-2-prepare-kubernetes-environment-1" class="hash-link" aria-label="Direct link to Step 2: Prepare Kubernetes Environment" title="Direct link to Step 2: Prepare Kubernetes Environment">​</a></h3>
<ol>
<li>
<p>Create a dedicated namespace:</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl create namespace gh-system</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Store your OAS as a ConfigMap (in this example, we use a sample OAS for GitHub teamrepos stored in assets of this repository):</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl create configmap teamrepo --from-file=samples/usage_guide/assets/teamrepo_no_ws.yaml -n gh-system</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-3-create-restdefinition-for-github-teamrepos">Step 3: Create RestDefinition for GitHub TeamRepos<a href="#step-3-create-restdefinition-for-github-teamrepos" class="hash-link" aria-label="Direct link to Step 3: Create RestDefinition for GitHub TeamRepos" title="Direct link to Step 3: Create RestDefinition for GitHub TeamRepos">​</a></h3>
<p>In order to create a RestDefinition for GitHub teamrepos, you need to define the resource group, resource kind, and the verbs that the controller will support. The <code>oasPath</code> should point to the ConfigMap containing your OAS. You can learn more about the <code>RestDefinition</code> resource <a href="/key-concepts/kog/oasgen-provider#restdefinition-specifications">here</a>.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat &lt;&lt;EOF | kubectl apply -f -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: ogen.krateo.io/v1alpha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: RestDefinition</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: gh-teamrepo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  namespace: gh-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  oasPath: configmap://gh-system/teamrepo/teamrepo_no_ws.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  resourceGroup: github.ogen.krateo.io</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  resource: </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    kind: TeamRepo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    additionalStatusFields:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - id </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - full_name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - permission</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    verbsDescription:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - action: create</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      method: PUT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      path: /orgs/{org}/teams/{team_slug}/repos/{owner}/{repo}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - action: delete</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      method: DELETE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      path: /orgs/{org}/teams/{team_slug}/repos/{owner}/{repo}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - action: get</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      method: GET</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      path: /orgs/{org}/teams/{team_slug}/repos/{owner}/{repo}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - action: update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      method: PUT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      path: /orgs/{org}/teams/{team_slug}/repos/{owner}/{repo}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="wait-for-the-crd-and-controller-to-be-created-1">Wait for the CRD and Controller to be Created<a href="#wait-for-the-crd-and-controller-to-be-created-1" class="hash-link" aria-label="Direct link to Wait for the CRD and Controller to be Created" title="Direct link to Wait for the CRD and Controller to be Created">​</a></h3>
<p>You can check the creation status by running:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl wait restdefinition gh-teamrepo --for condition=Ready=True --namespace gh-system --timeout=600s</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-4-verification-steps-1">Step 4: Verification Steps<a href="#step-4-verification-steps-1" class="hash-link" aria-label="Direct link to Step 4: Verification Steps" title="Direct link to Step 4: Verification Steps">​</a></h3>
<ol>
<li>
<p><strong>Check CRD creation:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get crds | grep github.ogen.krateo.io </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You should see:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">teamrepoconfigurations.github.ogen.krateo.io    2025-06-13T08:28:06Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">teamrepos.github.ogen.krateo.io             2025-06-13T08:28:06Z</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If you see <code>teamrepoconfigurations</code> and <code>teamrepos</code>, the CRDs are created successfully. The second CRD represents the <code>teamrepo</code> object, while the first one is the <code>teamrepoconfiguration</code> object used to authenticate requests to the GitHub API.</p>
<p><strong>Note:</strong> If you&#x27;ve previously created the <code>repo</code> RestDefinition, you&#x27;ll also see the <code>repoes.github.ogen.krateo.io</code> CRD.</p>
</li>
<li>
<p><strong>Verify controller deployment:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get deploy -n gh-system</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You should see a deployment named <code>gh-teamrepo-controller</code> responsible for managing the <code>teamrepo</code> resources.</p>
<p>If you see the deployment, check the controller pod logs to verify it&#x27;s running correctly:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl logs deploy/gh-teamrepo-controller -n gh-system</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p><strong>Check RestDefinition status:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get restdefinition -n gh-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl describe restdefinition gh-teamrepo -n gh-system</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<p>At this point, you have a running operator capable of handling GitHub teamrepos. You can create, update, and delete teamrepos using the custom resource.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-5-create-the-custom-resource">Step 5: Create the Custom Resource<a href="#step-5-create-the-custom-resource" class="hash-link" aria-label="Direct link to Step 5: Create the Custom Resource" title="Direct link to Step 5: Create the Custom Resource">​</a></h3>
<p>Before creating the <code>TeamRepo</code> custom resource, you need to create a <code>TeamRepoConfiguration</code> custom resource and a Kubernetes secret to store your GitHub token.</p>
<p>These are used to authenticate requests to the GitHub API. The <code>bearer</code> section of the spec of <code>TeamRepoConfiguration</code> contains a reference to the token that is used to authenticate the requests. The token is stored in a Kubernetes secret.</p>
<p>So first, create a Kubernetes secret with your GitHub token:
(generate a personal access token with the necessary permissions from your GitHub account settings)</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl create secret generic gh-token --from-literal=token=&lt;token&gt; -n gh-system </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat &lt;&lt;EOF | kubectl apply -f -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: github.ogen.krateo.io/v1alpha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: TeamRepoConfiguration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: my-teamrepo-config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  namespace: default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  authentication:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    bearer:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      # Reference to a secret containing the bearer token</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      tokenRef:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        name: gh-token        # Name of the secret</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        namespace: default    # Namespace where the secret exists</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        key: token            # Key within the secret that contains the token</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Create a custom resource for the <code>teamrepo</code> object. This is used to create, update, and delete teamrepos in the GitHub API. The <code>teamrepo</code> object contains a reference to the <code>TeamRepoConfiguration</code> object that is used to authenticate requests:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat &lt;&lt;EOF | kubectl apply -f -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: github.ogen.krateo.io/v1alpha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: TeamRepo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: test-teamrepo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  namespace: gh-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  configurationRef:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    name: my-teamrepo-config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    namespace: default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  org: krateoplatformops-test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  owner: krateoplatformops-test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  team_slug: test_team1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  repo: test-teamrepo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  permission: admin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The controller should add the GitHub team &quot;test_team1&quot; to the repository &quot;test-teamrepo&quot; in the organization &quot;krateoplatformops-test&quot; with &quot;admin&quot; permission. Check the teamrepo creation status by running:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl describe teamrepo.github.ogen.krateo.io/test-teamrepo -n gh-system</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You should see the teamrepo creation status and any errors that occurred during the process.</p>
<p>In this case, you should see that the teamrepo was created successfully with status <code>Ready</code>: <code>True</code>, but you should also notice that the <code>Message</code> field states &quot;Resource is assumed to be up-to-date. Returned body is nil.&quot;</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Status:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Conditions:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Last Transition Time:  2025-06-18T14:13:03Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Message:               Resource is assumed to be up-to-date. Returned body is nil.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Reason:                Available</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Status:                True</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Type:                  Ready</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Events:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Type    Reason                   Age   From  Message</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ----    ------                   ----  ----  -------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Normal  CreatedExternalResource  86s         Successfully requested creation of external resource</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This message indicates that the controller was able to create the teamrepo in GitHub, but the response body from the GitHub API is nil. This is expected behavior as described <a href="https://docs.github.com/en/rest/teams/teams?apiVersion=2022-11-28#check-team-permissions-for-a-repository" target="_blank" rel="noopener noreferrer">here</a>. According to the GitHub API documentation, the response body for this endpoint is empty when the request is successful but the accept header isn&#x27;t set to <code>application/vnd.github.v3+json</code>. This is a known limitation of the GitHub API, and it&#x27;s not possible to change the accept header for requests made by the <code>rest-dynamic-controller</code> directly.</p>
<p>To add the header to the request, we need to implement a web service that handles API calls to the GitHub API. The web service will be responsible for adding the header to the request and returning the response body, since the <code>rest-dynamic-controller</code> doesn&#x27;t support adding headers to requests made to external APIs.</p>
<p>In addition to the header issue, the response body from the GitHub API for this endpoint is also not in a format that is compatible with the <code>rest-dynamic-controller</code>. The response body contains uses a legacy format for permission values and the controller won&#x27;t be able to compare the fields in the response body with the fields in the custom resource. Therefore, the web service normalizes permission values (write → push, read → pull).</p>
<p>Moreover, the <code>owner</code> field in the response body is not on the same level as the other fields in the custom resource, which makes it impossible for the <code>rest-dynamic-controller</code> to compare the fields correctly. The web service will also flatten the response body to bring the <code>owner</code> field to the root level.</p>
<p>More information about the web service endpoint can be found <a href="https://github.com/krateoplatformops/github-rest-dynamic-controller-plugin/blob/main/README.md#get-teamrepo-permission" target="_blank" rel="noopener noreferrer">here</a></p>
<p>Note: with a recent update of <code>oasgen-provider</code> and <code>rest-dynamic-controller</code>, it is now possible to add custom headers to the requests made to the external API by using configuration resources (e.g., <code>TeamRepoConfiguration</code>). However, this feature is not sufficient in this case because the response body from the GitHub API is still not in a format that is compatible with the <code>rest-dynamic-controller</code>. Therefore, we still need to implement a web service to handle the response body.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-6-create-the-web-service-for-teamrepo-management">Step 6: Create the Web Service for TeamRepo Management<a href="#step-6-create-the-web-service-for-teamrepo-management" class="hash-link" aria-label="Direct link to Step 6: Create the Web Service for TeamRepo Management" title="Direct link to Step 6: Create the Web Service for TeamRepo Management">​</a></h3>
<p>At this point, we need to implement a web service that handles API calls to the GitHub API. In this case, the web service will only be responsible for the <code>get</code> operation for teamrepos, because the <code>create</code>, <code>delete</code>, and <code>update</code> operations are handled directly by the controller without any additional processing.</p>
<p>To handle this case, we&#x27;ve implemented a web service that handles the <code>get</code> operation for teamrepos. You can check the implementation at this link: <a href="https://github.com/krateoplatformops/github-rest-dynamic-controller-plugin/blob/main/internal/handlers/teamRepo/teamRepo.go" target="_blank" rel="noopener noreferrer">GitHub Plugin for rest-dynamic-controller</a>. You can also check the <a href="https://github.com/krateoplatformops/github-rest-dynamic-controller-plugin/blob/main/README.md" target="_blank" rel="noopener noreferrer">README</a> for more information on running and why it has been implemented.</p>
<p><strong>Note:</strong> <code>rest-dynamic-controller</code> to check if the CR is up-to-date or not, checks the fields in the CR (spec and status) against the fields in the response body from the external API. <strong>It compare the fields at the same level</strong>, so if the response fields are more nested than the fields in the CR, it will not be able to compare them correctly. This is why we need to implement a web service that returns the response body with the same structure as the CR. This problem is quite common and a specific solution has been described <a href="https://github.com/krateoplatformops/github-rest-dynamic-controller-plugin/blob/main/README.md#get-teamrepo-permission" target="_blank" rel="noopener noreferrer">here</a>.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat &lt;&lt;EOF | kubectl apply -f -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">---</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: Service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: github-provider-plugin-krateo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  namespace: default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  selector:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    app: github-provider-plugin-krateo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ports:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - protocol: TCP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      port: 8080</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      targetPort: 8080</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">---</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: apps/v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: Deployment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: github-provider-plugin-krateo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  namespace: default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  replicas: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  selector:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    matchLabels:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      app: github-provider-plugin-krateo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  template:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      labels:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        app: github-provider-plugin-krateo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      containers:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        - name: github-provider-plugin-krateo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          image: ghcr.io/krateoplatformops/github-rest-dynamic-controller-plugin:0.0.3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          ports:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            - containerPort: 8080</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-7-update-the-oas-to-use-the-web-service">Step 7: Update the OAS to Use the Web Service<a href="#step-7-update-the-oas-to-use-the-web-service" class="hash-link" aria-label="Direct link to Step 7: Update the OAS to Use the Web Service" title="Direct link to Step 7: Update the OAS to Use the Web Service">​</a></h3>
<p>Now we need to tell the <code>rest-dynamic-controller</code> to use the web service to handle the <code>get</code> operation for TeamRepoes. We can do this by adding the plugin URL to the OpenAPI specification of the <code>teamrepo</code> RestDefinition.
We can accomplish this by adding the <code>servers</code> field to the endpoint in the OpenAPI specification (<a href="https://swagger.io/docs/specification/v3_0/api-host-and-base-path/#overriding-servers" target="_blank" rel="noopener noreferrer">https://swagger.io/docs/specification/v3_0/api-host-and-base-path/#overriding-servers</a>).
In this case, the URL will be <code>http://github-provider-plugin-krateo.default.svc.cluster.local:8080</code> because the web service is running in the <code>default</code> namespace with the service name <code>github-provider-plugin-krateo</code>.</p>
<p>Let&#x27;s create a new configmap with the updated OpenAPI specification:
`</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl create configmap teamrepo-ws --from-file=samples/cheatsheet/assets/teamrepo_ws.yaml -n gh-system</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>As you can see, the new OpenAPI specification also includes another endpoint for the <code>get</code> operation that points to the web service URL:</p>
<div class="language-diff codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-diff codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">paths:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;/teamrepository/orgs/{org}/teams/{team_slug}/repos/{owner}/{repo}&quot;:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    get:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+     servers:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+     - url: http://github-provider-plugin-krateo.default.svc.cluster.local:8080</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This means that when the <code>rest-dynamic-controller</code> handles the <code>get</code> operation for TeamRepoes, it will call the web service instead of the GitHub API directly.
Note that this happens <strong>just for the <code>get</code> operation</strong>, while the other operations (<code>create</code>, <code>delete</code>, and <code>update</code>) will still call the GitHub API directly as defined in the original OpenAPI specification (<code>servers</code> field at the root level of the OAS).</p>
<p>The web service will then add the necessary headers to the request and return a processed response body that is compatible with the <code>rest-dynamic-controller</code>.</p>
<p>Now we need to update the <code>RestDefinition</code> to use the new configmap:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat &lt;&lt;EOF | kubectl apply -f -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: ogen.krateo.io/v1alpha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: RestDefinition</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: gh-teamrepo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  namespace: gh-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  oasPath: configmap://gh-system/teamrepo-ws/teamrepo_ws.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  resourceGroup: github.ogen.krateo.io</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  resource: </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    kind: TeamRepo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    additionalStatusFields:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - id </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - full_name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - permission</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    verbsDescription:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - action: create</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      method: PUT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      path: /orgs/{org}/teams/{team_slug}/repos/{owner}/{repo}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - action: delete</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      method: DELETE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      path: /orgs/{org}/teams/{team_slug}/repos/{owner}/{repo}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - action: get</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      method: GET</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      path: /teamrepository/orgs/{org}/teams/{team_slug}/repos/{owner}/{repo}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - action: update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      method: PUT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      path: /orgs/{org}/teams/{team_slug}/repos/{owner}/{repo}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>We expect the controller to update the RestDefinition and start using the web service to handle the <code>get</code> operation for teamrepos.</p>
<p>At this point, the <code>rest-dynamic-controller</code> should be able to handle the <code>get</code> operation for teamrepos using the web service. You can check the status of the TeamRepo resource by running:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl describe teamrepo.github.ogen.krateo.io/test-teamrepo -n gh-system</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You should see that the message field is now empty, which means the RestDefinition is ready and correctly observed by the controller.
Note that you should wait for the reconciliation loop to run, which may take a few minutes.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-8-update-the-custom-resource">Step 8: Update the Custom Resource<a href="#step-8-update-the-custom-resource" class="hash-link" aria-label="Direct link to Step 8: Update the Custom Resource" title="Direct link to Step 8: Update the Custom Resource">​</a></h3>
<p>To check if the remote resource changes along with the custom resource, you can run the following command to change the teamrepo&#x27;s permission:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat &lt;&lt;EOF | kubectl apply -f -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: github.ogen.krateo.io/v1alpha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: TeamRepo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: test-teamrepo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  namespace: gh-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  configurationRef:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    name: my-teamrepo-config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    namespace: default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  org: krateoplatformops-test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  owner: krateoplatformops-test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  team_slug: test_team1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  repo: test-teamrepo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  permission: pull</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>After a few seconds, you should see that the teamrepo&#x27;s permission is updated in GitHub. Check the teamrepo status by running:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl describe teamrepo.github.ogen.krateo.io/test-teamrepo -n gh-system</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You should see that the permission is updated to <code>pull</code>, the status is set to <code>Ready</code>: <code>True</code>, and events indicate that the external resource was updated successfully:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Events:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Type     Reason                         Age                  From  Message</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ----     ------                         ----                 ----  -------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Normal   UpdatedExternalResource        77s (x2 over 80s)             Successfully requested update of external resource</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-9-delete-the-custom-resource">Step 9: Delete the Custom Resource<a href="#step-9-delete-the-custom-resource" class="hash-link" aria-label="Direct link to Step 9: Delete the Custom Resource" title="Direct link to Step 9: Delete the Custom Resource">​</a></h3>
<p>To delete the teamrepo, you can delete the <code>TeamRepo</code> custom resource:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl delete teamrepo.github.ogen.krateo.io test-teamrepo -n gh-system</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This will trigger the controller to delete the corresponding teamrepo in GitHub.</p>
<p>You should see an event for the TeamRepo resource indicating that the external resource was deleted successfully. Check the deletion status by running:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get events --sort-by=&#x27;.lastTimestamp&#x27; -n gh-system | grep teamrepo/test-teamrepo</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Events:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Type     Reason                         Age                  From  Message</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ----     ------                         ----                 ----  -------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Normal   DeletedExternalResource      teamrepo/test-teamrepo        Successfully requested deletion of external resource</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This indicates that the teamrepo was deleted successfully from GitHub. You can manually check the GitHub UI to confirm that the teamrepo is no longer present.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="best-practices">Best Practices<a href="#best-practices" class="hash-link" aria-label="Direct link to Best Practices" title="Direct link to Best Practices">​</a></h2>
<ol>
<li><strong>Incremental Development</strong>: Start with a small subset of endpoints and gradually expand</li>
<li><strong>Log inspection</strong>: Regularly check controller logs for errors, warnings or to verify correct behavior</li>
<li><strong>Documentation</strong>: Maintain a changelog for your OAS modifications (if any)</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="troubleshooting">Troubleshooting<a href="#troubleshooting" class="hash-link" aria-label="Direct link to Troubleshooting" title="Direct link to Troubleshooting">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="common-issues">Common Issues<a href="#common-issues" class="hash-link" aria-label="Direct link to Common Issues" title="Direct link to Common Issues">​</a></h3>
<ul>
<li><strong>CRD not created</strong>: Check RestDefinition status and controller logs</li>
<li><strong>Authentication issues</strong>: Verify <code>securitySchemes</code> in OAS match actual API requirements</li>
<li><strong>Type errors</strong>: Ensure all fields have proper type definitions</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="detailed-solutions">Detailed Solutions<a href="#detailed-solutions" class="hash-link" aria-label="Direct link to Detailed Solutions" title="Direct link to Detailed Solutions">​</a></h3>
<ol>
<li>
<p><strong>Conversion from OAS 2.0 to 3.0:</strong></p>
<ul>
<li>Use <a href="https://editor.swagger.io" target="_blank" rel="noopener noreferrer">Swagger Editor</a> for conversion</li>
<li>Manually review and correct any conversion issues</li>
</ul>
</li>
<li>
<p><strong>Inconsistent API interfaces:</strong></p>
<ul>
<li>Create a web service wrapper to normalize interfaces.</li>
<li>There are no constraints on the technology used for the web service.</li>
<li>Example implementations available in <a href="https://github.com/krateoplatformops/azuredevops-oas3-plugin" target="_blank" rel="noopener noreferrer">Java</a> and <a href="https://github.com/krateoplatformops/github-oas3-plugin" target="_blank" rel="noopener noreferrer">Python</a>.</li>
</ul>
</li>
<li>
<p><strong>Authentication issues:</strong></p>
<ul>
<li>Verify secret references in Configuration resources</li>
<li>Ensure tokens/credentials have necessary permissions</li>
<li>Check network connectivity to API endpoints</li>
<li>Enable verbose logging with annotations (see below)</li>
</ul>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="debug-mode">Debug Mode<a href="#debug-mode" class="hash-link" aria-label="Direct link to Debug Mode" title="Direct link to Debug Mode">​</a></h3>
<p>To troubleshoot Krateo controllers, add the annotation <code>krateo.io/connector-verbose: &quot;true&quot;</code> to the CR you want to debug. This enables verbose logging for the controller and helps you understand what&#x27;s happening under the hood.</p>
<p><strong>Examples:</strong></p>
<ul>
<li>Adding this annotation to a <code>RestDefinition</code> will help you understand what happens when the controller tries to create the CRD and controller for the RestDefinition</li>
<li>Adding it to a <code>Repo</code> or <code>TeamRepo</code> CR will help you understand what happens when the controller tries to create, update, or delete the external resource, and will log any HTTP requests and responses made to the external API</li>
</ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/key-concepts/kog/oasgen-provider"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Krateo OASGen Provider</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/key-concepts/kog/rest-dynamic-controller"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">rest-dynamic-controller</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#table-of-contents" class="table-of-contents__link toc-highlight">Table of Contents</a></li><li><a href="#prerequisites" class="table-of-contents__link toc-highlight">Prerequisites</a></li><li><a href="#what-to-do-when-the-openapi-specification-oas-is-missingincomplete-or-not-at-version-30" class="table-of-contents__link toc-highlight">What to do when the OpenAPI Specification (OAS) is missing/incomplete or not at version 3.0+?</a><ul><li><a href="#first-scenario-the-service-does-not-provide-an-openapi-specification-oas-but-it-exposes-a-rest-api" class="table-of-contents__link toc-highlight">First Scenario: the service does not provide an OpenAPI Specification (OAS) but it exposes a REST API</a></li><li><a href="#second-scenario-the-service-does-not-expose-a-rest-api-but-you-have-another-way-to-interact-with-it-eg-grpc-graphql-etc" class="table-of-contents__link toc-highlight">Second Scenario: the service does not expose a REST API but you have another way to interact with it (e.g., gRPC, GraphQL, etc.)</a></li><li><a href="#about-openapi-specification-oas-30" class="table-of-contents__link toc-highlight">About OpenAPI Specification (OAS) 3.0+</a></li><li><a href="#supported-authentication-methods" class="table-of-contents__link toc-highlight">Supported authentication methods</a></li></ul></li><li><a href="#simple-case-external-apis-compatible-with-k8s-resource-management" class="table-of-contents__link toc-highlight">Simple Case: External APIs Compatible with K8s Resource Management</a><ul><li><a href="#step-1-prepare-your-openapi-specification" class="table-of-contents__link toc-highlight">Step 1: Prepare Your OpenAPI Specification</a></li><li><a href="#step-2-prepare-kubernetes-environment" class="table-of-contents__link toc-highlight">Step 2: Prepare Kubernetes Environment</a></li><li><a href="#step-3-create-restdefinition-for-github-repositories" class="table-of-contents__link toc-highlight">Step 3: Create RestDefinition for GitHub Repositories</a></li><li><a href="#step-4-verification-steps" class="table-of-contents__link toc-highlight">Step 4: Verification Steps</a></li><li><a href="#step-5-create-the-custom-resources" class="table-of-contents__link toc-highlight">Step 5: Create the Custom Resources</a></li><li><a href="#step-6-patch-the-custom-resource" class="table-of-contents__link toc-highlight">Step 6: Patch the Custom Resource</a></li><li><a href="#step-7-delete-the-custom-resource" class="table-of-contents__link toc-highlight">Step 7: Delete the Custom Resource</a></li></ul></li><li><a href="#extended-example-external-api-that-requires-a-plugin-to-handle-external-api-calls" class="table-of-contents__link toc-highlight">Extended Example: External API that requires a plugin to handle external API calls</a><ul><li><a href="#step-1-prepare-your-openapi-specification-1" class="table-of-contents__link toc-highlight">Step 1: Prepare Your OpenAPI Specification</a></li><li><a href="#step-2-prepare-kubernetes-environment-1" class="table-of-contents__link toc-highlight">Step 2: Prepare Kubernetes Environment</a></li><li><a href="#step-3-create-restdefinition-for-github-teamrepos" class="table-of-contents__link toc-highlight">Step 3: Create RestDefinition for GitHub TeamRepos</a></li><li><a href="#wait-for-the-crd-and-controller-to-be-created-1" class="table-of-contents__link toc-highlight">Wait for the CRD and Controller to be Created</a></li><li><a href="#step-4-verification-steps-1" class="table-of-contents__link toc-highlight">Step 4: Verification Steps</a></li><li><a href="#step-5-create-the-custom-resource" class="table-of-contents__link toc-highlight">Step 5: Create the Custom Resource</a></li><li><a href="#step-6-create-the-web-service-for-teamrepo-management" class="table-of-contents__link toc-highlight">Step 6: Create the Web Service for TeamRepo Management</a></li><li><a href="#step-7-update-the-oas-to-use-the-web-service" class="table-of-contents__link toc-highlight">Step 7: Update the OAS to Use the Web Service</a></li><li><a href="#step-8-update-the-custom-resource" class="table-of-contents__link toc-highlight">Step 8: Update the Custom Resource</a></li><li><a href="#step-9-delete-the-custom-resource" class="table-of-contents__link toc-highlight">Step 9: Delete the Custom Resource</a></li></ul></li><li><a href="#best-practices" class="table-of-contents__link toc-highlight">Best Practices</a></li><li><a href="#troubleshooting" class="table-of-contents__link toc-highlight">Troubleshooting</a><ul><li><a href="#common-issues" class="table-of-contents__link toc-highlight">Common Issues</a></li><li><a href="#detailed-solutions" class="table-of-contents__link toc-highlight">Detailed Solutions</a></li><li><a href="#debug-mode" class="table-of-contents__link toc-highlight">Debug Mode</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Krateo</div></div></div></footer></div>
</body>
</html>